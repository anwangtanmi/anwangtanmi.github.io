<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>IDE on 暗网探秘</title>
    <link>https://anwangtanmi.github.io/tags/ide/</link>
    <description>Recent content in IDE on 暗网探秘</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Thu, 11 May 2017 14:47:30 +0800</lastBuildDate>
    <atom:link href="https://anwangtanmi.github.io/tags/ide/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>关于开机出现“安装程序正在为首次使用计算机做准备”的解决方案及微软OOBE与SYSPREP的实用技巧</title>
      <link>https://anwangtanmi.github.io/posts/f97c7511f34bba51344afc605544232f/</link>
      <pubDate>Thu, 11 May 2017 14:47:30 +0800</pubDate>
      <guid>https://anwangtanmi.github.io/posts/f97c7511f34bba51344afc605544232f/</guid>
      <description> 最近我的电脑遇到了些麻烦，每次开机的时候都会在启动WINDOWS后出现“安装程序正在为首次使用计算机做准备”，大约半分钟左右，就可以正常进入登陆界面，但使用中也没发现什么异常。所有程序并没有被还原或反注册表。不过每次开机都要有这个过程，确实比较烦人，于是寻求解决方案。&#xA;经过网上搜索，查找到有如下几种解决方法：&#xA;方法一：&#xA;“开始→运行”，在“运行”对话框中输入“regedit”打开注册表编辑器，依次选择“HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SessionManager”子键，然后在右侧窗口中找到“BootExecute”键值项并将其数值清空，最后按“F5”键刷新注册表即可。&#xA;此种方法看上去说得通，但是BootExecute从字面可以了解，是启动执行的意思。里面默认包含的内容是autocheck autochk* 这是一个长字符类型的键值。经过与正常启动的WINDOWS注册表相应键值比对，没发现异常，因此这个方法没有尝试，据网上资料反映，不起作用。&#xA;方法二：&#xA;打卡WINDOWS所在分区，进入Windows\System32\oobe目录，运行oobe目录下的setupsqm.exe程序。&#xA;从某种角度讲，这有可能行得通，因为oobe这个文件夹中的文件是管系统安装相关内容的（具体在后文详述），于是运行了该程序，只是弹出来一个黑色方框，类似于命令提示符的样子，一闪而过。重新启动后，讨厌的内容依旧存在，此方法无效。&#xA;其他还有一些网络上流传的方法，如修改配置文件，重新创建账户，禁用Update服务，利用批处理激活管理员等，那些方法有些看上去就不靠谱，有些经过i实践，无效，下面我说下我的解决方案。&#xA;解决方案：&#xA;以管理员的身份登陆系统，如Administrator或与其在同一组的用户名（系统安装过程中创建的账户多为管理员账户），如果无法确定，或本身不是管理员，可按下述方法激活Administrator帐号。&#xA;开始菜单，找到运行（如没有可按Windows徽标键+R）输入mmc.exe打开控制台，选择文件菜单下的添加或删除管理单元，如下图所示：&#xA;在左侧找到本地用户和组，选中点添加，会弹出一对话框，默认完成即可。此时可以看到右侧的所选管理单元中出现刚刚选择的内容，按确定。此时可以看到控制台中多出了所选内容，依次展开左侧的内容，可以看到用户，右侧显示当前系统中存在的用户帐户，如下图：&#xA;可以看到，Administrator有个下箭头，表示该用户处于禁用状态，右键属性将禁用的勾去掉后确定。此时Administrator账户激活，注销当前用户，即可切换到Administrator账户。&#xA;以Administrator账户登陆系统后，进入系统所在分区下的Windows\system32\sysprep\目录，可以看到同名文件sysprep.exe&#xA;关于SYSPREP文件，其含义为系统准备程序，即SYSTEM Prepare，改程序的作用本意是为计算机制造商预装系统用的，我们知道品牌机预装系统本身并不是单单只有一个系统，还包括必备的驱动程序和制造商为该计算机设计的软件等，甚至有些还预装有Office办公软件等，这些是怎么预装到系统的呢？其实制造商也是通过Windows安装文件先安装的完整的系统，之后逐一安装好所需的驱动及软件。最后通过SYSPREP程序对系统进行全新封装，以给用户提供全新体验，给用户感觉是没有系统使用过的痕迹。&#xA;继续上面解决方案，运行sysprep程序，可以看到打开了一个名为系统准备工具的程序，我们只许保持默认设置即可。关机选项默认是重新启动，建议保留，后选择关机，不建议选择退出。&#xA;稍等片刻，系统就会准备好全新体验模式，随后会注销关机，重新启动计算机后，就会再一次看到那个“安装程序正在为首次使用计算机做准备”的界面，但这次与之前不同，稍后还会弹出正在进行视频卡检测等，如图刚刚安装好的系统一样。稍等片刻，便会弹出系统欢迎界面，我们要做的就是一步一步设定，相信安装过系统的朋友一定不会陌生这些设置。&#xA;设定好后，系统会进入刚刚创建的账户，如果你觉得还希望使用以前的帐号，没关系，重复之前调用管理员账户Administrator的方法，同样可以激活以前的账户，注销新用户，登陆以前的帐号，熟悉的桌面又回来了，此时可以通过控制面板将新账户删掉，这样你得系统就如原先一样，但速度要比原先略快些，因为一切系统已经进入全新体验了，也就是说你刚刚完成了一个预装有软件的新系统的安装。&#xA;再次重新启动，发现之前那个讨厌的界面不见了，至此该问题得到彻底解决。&#xA;那么如何造成该问题的出现呢？其实是我们有意或无意间运行了system32\oobe下的audit.exe，导致激活了新系统配置进程，但又无法正确完成，因此导致每次开机都会出现。关于oobe文件夹中的内容，其实是Out Of Box Experience所在目录，该目录中的文件主要用于系统安装后的配置向导，如该进程下的msoobe.exe就是我们刚刚进行系统配置，账户创建，网络设置的那个向导程序。系统安装后首先激活SYSTEM账户，而激活该账户的唯一目的是启动msoobe进程。&#xA;其实通过sysprep，msoobe我们还可以自己集成系统，制作属于自己的系统安装光盘，这就留给读者自己去研究了。&#xA;点赞 收藏 分享 文章举报 树上的疯子^ 发布了548 篇原创文章 ·&#xA;获赞 140 ·&#xA;访问量 99万+ 他的留言板 关注 </description>
    </item>
  </channel>
</rss>
