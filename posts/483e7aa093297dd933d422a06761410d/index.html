<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>高级纹理映射知识汇总 - 暗网探秘</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="高级纹理映射知识汇总" />
<meta property="og:description" content="参考整理自： http://17de.com/library/d3d_6im/d3dim6_20.htm http://www.cppblog.com/lovedday/archive/2008/05/22/50782.html 多阶层纹理的基本概念 纹理拥有一个surface表面和格式大小等数据，后台缓存也有一个surface,是可以从后台缓存获取surface拷贝到texture的surface的但是有点影响效率。 这里多阶层纹理融合是指对单个物体多边形顶点像素上设置多个阶层纹理时候的融合操作，最终得到物体多边形顶点像素上的颜色。而
一般的融合指着色阶段的网格物体颜色和后台缓存的融合，该blend融合也可以设置融合操作和基于颜色还是alpha融合。 多通道纹理
(多次渲染, 每次设置一个纹理)已经不用了，现在DX6后都是用单通道多阶层Stage纹理（一次渲染可以将多个纹理融合到一个多边形顶点上），老的多通道纹理是可以转换到多阶层纹理的。 多阶段纹理设置的才启用，不设置的不启用，如果要禁用一个阶段纹理设置它的颜色操作为COLOROP_DISABLE即可。
Device-&gt;SetTextureStageState(i, D3DTSS_COLOROP, D3DTOP_DISABLE); Device-&gt;SetTextureStageState(i, D3DTSS_ALPHAOP, D3DTOP_DISABLE); 每个阶段纹理都有自己的对应纹理指针对象，和纹理采用的顶点坐标，还有纹理过滤的采样状态。 Device-&gt;SetTexture(i, pTexObj); Device-&gt;SetTextureStageState(i, D3DTSS_TEXCOORDINDEX, 0); Device-&gt;SetSamplerState(
i, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(
i, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); // MipMapTexture 多幅渐进纹理,在CreateTextureFromFile和CreateTextureFromFileEx时候就会创建，这里选择纹理采用线性插值 Device-&gt;SetSamplerState(
i, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); 每个阶段纹理都有自己的两个参数纹理和操作，两个参数arg1和arg2, arg1是当前stage的纹理，arg2是第0层纹理或者是上一层融合的结果纹理，操作有两种分别是alpha操作和颜色操作，两个参数arg1和arg2 会根据操作进行设置值，操作就是指在两个颜色之间进行的从操作：color = arg1 opr arg2, opr是D3DTOP_ADD就是加，不会像物体和后台缓存融合一样先进行分量乘再相加。 pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_XXXARG1, D3DTA_XXX); pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_XXXARG2, D3DTA_XXX); pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_XXXOP, D3DTOP_XXX); 阶段状态前缀：D3DTSS_ 前缀是Texture stage state, 有D3DTSS_COLOROP和D3DTSS_ALPHAOP以及他们相同的操作值，有 D3DTSS_COLORARG1相同以及他们相同的操作值。
状态的值类型为：D3DTOP_ 前缀是Operation。 或者状态的值类型为：D3DTA_ 前缀是Texture Argument。 参数一般是两元组合，如果需要三元组合操作那么需要： D3DTSS_COLORARG0 = 26, /* D3DTA_* third arg for triadic ops */ D3DTSS_ALPHAARG0 = 27, /* D3DTA_* third arg for triadic ops */ 检测多阶层纹理融合阶层数： D3DCAPS9 pCaps; Device-&gt;GetDeviceCaps(&amp;pCaps); if(pCaps." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anwangtanmi.github.io/posts/483e7aa093297dd933d422a06761410d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-08-03T08:56:49+08:00" />
<meta property="article:modified_time" content="2015-08-03T08:56:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="暗网探秘" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">暗网探秘</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">高级纹理映射知识汇总</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2015-08-03T08:56:49&#43;08:00">2015-08-03</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" rel="category">图像处理</a>
	</span>
</div></div>
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div class="entry-content clearfix">
<div id="article_content" class="article_content clearfix">
<br>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-d284373521.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-d284373521.css">
<div class="htmledit_views" id="content_views">
<div style>
<strong style="background-color:inherit">参考整理自：</strong>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
<a target="_blank" href="http://17de.com/library/d3d_6im/d3dim6_20.htm" rel="nofollow noopener noreferrer" style="background-color:inherit" data-token="4e1be1ffd6a3277f2c8f7822fb587f58">http://17de.com/library/d3d_6im/d3dim6_20.htm</a>
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
<a target="_blank" href="http://www.cppblog.com/lovedday/archive/2008/05/22/50782.html" rel="nofollow noopener noreferrer" style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left" data-token="1dbae5a2a5762d2fafea54d1fdcffb09">http://www.cppblog.com/lovedday/archive/2008/05/22/50782.html</a>
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
<br style="background-color:inherit">
</div>
</div>
<div style>
<h2><strong style="background-color:inherit">多阶层纹理的基本概念</strong></h2>
</div>
<div style>
纹理拥有一个surface表面和格式大小等数据，后台缓存也有一个surface,是可以从后台缓存获取surface拷贝到texture的surface的但是有点影响效率。
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">这里多阶层纹理融合是指对单个物体多边形顶点像素上设置多个阶层纹理时候的融合操作，最终得到物体多边形顶点像素上的颜色。而</span><br>
<br style="background-color:inherit">
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
一般的融合指着色阶段的网格物体颜色和后台缓存的融合，该blend融合也可以设置融合操作和基于颜色还是alpha融合。
</div>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
多通道纹理<br>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">(多次渲染, 每次设置一个纹理)</span>已经不用了，现在DX6后都是用单通道多阶层Stage纹理（一次渲染可以将多个纹理融合到一个多边形顶点上），老的多通道纹理是可以转换到多阶层纹理的。
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">多阶段纹理设置的才启用，不设置的不启用，如果要禁用一个阶段纹理设置它的颜色操作为COLOROP_DISABLE即可。</span><br>
<br style="background-color:inherit">
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="color:#c00000; background-color:inherit">Device-&gt;SetTextureStageState(i, D3DTSS_<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">COLOROP</span>, D3DTOP_DISABLE);</span></span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-weight:normal; text-align:left"><span style="color:#c00000; background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">Device-&gt;SetTextureStageState(</span><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">i,</span><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span> </span>D3DTSS_ALPHAOP</span><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">, D3DTOP_DISABLE);</span></span><br style="background-color:inherit"> </span>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><br style="background-color:inherit"> </span>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">每个阶段纹理都有自己的对应纹理指针对象，和纹理采用的顶点坐标，还有</span><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">纹理过滤的采样状态</span><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">。</span><br style="background-color:inherit"> </span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="color:#c00000; background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">Device-&gt;SetTexture(i, pTexObj);</span><br style="background-color:inherit"> </span></span></span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="color:#c00000; background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"> Device-&gt;SetTextureStageState(i, D3DTSS_TEXCOORDINDEX, 0);<span style="background-color:inherit"> </span></span><br style="background-color:inherit"> </span></span></span></span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left"><span style="color:#c00000; background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="background-color:inherit"><br style="background-color:inherit"> </span></span></span></span></span></span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; text-align:left"><span style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; text-align:left"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); text-align:left"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); text-align:left"><span style="color:#c00000; background-color:inherit"></span></span></span></span></span>
<div style="background-color:rgb(255,255,255); font-weight:normal; font-family:微软雅黑; font-size:14px; text-align:left">
<span style="background-color:inherit; font-style:normal"> Device-&gt;SetSamplerState(</span><br>
<em style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">i,<span style="background-color:inherit"> </span></span></em>D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);
</div>
<div style="background-color:rgb(255,255,255); font-weight:normal; font-family:微软雅黑; font-size:14px; text-align:left">
<span style="background-color:inherit; font-style:normal"> Device-&gt;SetSamplerState(</span><br>
<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">i,<span style="background-color:inherit"> </span></span><br>
<span> </span>D3DSAMP_MINFILTER, D3DTEXF_LINEAR);
</div>
<div style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; text-align:left">
<span style="background-color:inherit; font-weight:normal">//<span> </span></span><br>
<strong style="background-color:inherit">MipMapTexture </strong><br>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-weight:normal; font-style:normal; text-align:left">多幅渐进纹理,在CreateTextureFromFile和<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">CreateTextureFromFileEx时候就会创建，这里选择纹理采用线性插值</span></span>
</div>
<div style="background-color:rgb(255,255,255); font-weight:normal; font-style:normal; font-family:微软雅黑; font-size:14px; text-align:left">
 Device-&gt;SetSamplerState(<br>
<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">i,<span style="background-color:inherit"> </span></span>D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);
</div>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><br style="background-color:inherit"> </span></span></span>
</div>
<div style>
每个阶段纹理都有自己的两个参数纹理和操作，两个参数arg1和arg2, arg1是当前stage的纹理，arg2是第0层纹理或者是上一层融合的结果纹理，操作有两种分别是alpha操作和颜色操作，两个参数arg1和arg2 会根据操作进行设置值，操作就是指在两个颜色之间进行的从操作：color =  arg1 opr arg2, opr是D3DTOP_ADD就是加，不会像物体和后台缓存融合一样先进行分量乘再相加。
</div>
<div style>
<span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_XXXARG1, D3DTA_XXX);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">XXX</span>ARG2, D3DTA_XXX);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(i, D3DTSS_<span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">XXX</span>OP, D3DTOP_XXX);</span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">阶段状态前缀：D3DTSS_ 前缀是Texture stage state, 有<span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">D3DTSS_COLOROP和<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">D3DTSS_ALPHAOP以及他们相同的操作值，有<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="background-color:inherit"> </span>D3DTSS_COLORARG1相同以及他们相同的操作值</span>。</span></span></span><br>
<br style="background-color:inherit">
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">状态的值类型为：D3DTOP_ 前缀是Operation。</span></span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); line-height:1.5">或者状态的值类型为：D3DTA_  前缀是Texture Argument。</span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); line-height:1.5"><br style="background-color:inherit"> </span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); line-height:1.5">参数一般是两元组合，如果需要三元组合操作那么需要：</span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); line-height:1.5"> D3DTSS_COLORARG0      = 26, /* D3DTA_* third arg for triadic ops */</span>
</div>
<div style>
<span style="background-color:rgb(255,255,255); line-height:1.5"> D3DTSS_ALPHAARG0      = 27, /* D3DTA_* third arg for triadic ops */</span>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
检测多阶层纹理融合阶层数：
</div>
<div style>
D3DCAPS9 pCaps;
</div>
<div style>
 Device-&gt;GetDeviceCaps(&amp;pCaps);
</div>
<div style>
 if(pCaps.MaxTextureBlendStages &lt;= 1)
</div>
<div style>
  return false;
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h2><strong style="background-color:inherit">纹理阶层的用法</strong></h2>
</div>
<div style>
<h3><strong style="background-color:inherit">1.<span style="background-color:inherit; line-height:1.5">可以用纹理阶层指定获取alpha值，默认是D3DTA_TEXTURE的</span></strong></h3>
</div>
<div style>
// 可以用当前纹理阶段选择alpha值，可以选择来自纹理或者来自漫反射光
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE/*D3DTA_DIFFUSE*/);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
Device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA);
</div>
<div style>
 Device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true);
</div>
<div style>
// 绘制物体
</div>
<div style>
Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, false);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3><strong style="background-color:inherit">2.用于指定<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="background-color:inherit">纹理和光照混合(一般是第0阶层纹理)，默认是采用顶点纹理值和光照相乘的</span></span></strong></h3>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
Device-&gt;SetTexture(0, BackTex);
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"> Device-&gt;SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, 0);<span> </span></span><br>
<br style="background-color:inherit">
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">// 纹理阶段设置</span>
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_MODULATE);<br>
<span> </span><br>
<span style="color:#00b050; background-color:inherit">// 用D3DTOP_ADD可以实现强光照效果，白光</span>
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
 //<br>
<span> </span><br>
<span style="color:#ff0000; background-color:inherit">颜色参数来自顶点光照漫反射颜色，如果没有开启光照那么arg1 x arg2颜色也不会有问题 ，<span style="font-family:微软雅黑; font-size:14px; color:#ff00; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">会得到arg1的颜色，</span></span>
</div>
<div style>
 //<br>
<span> </span><br>
<span style="color:#ff0000; background-color:inherit">或者很多多阶层融合纹理都是第0阶层3DTSS_COLOROP值取D3DTOP_SELECTARG1就可以了。</span>
</div>
<div style>
 //<br>
<span style="color:#ff0000; background-color:inherit"> 可用3DTSS_COLOROP值取D3DTOP_SELECTARG1来避免光照影响，也就是顶点颜色融合不采用光照。</span>
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG2, D3DTA_DIFFUSE);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_DISABLE);
</div>
<div style>
// 纹理采样设置
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
// 光照开启，使得多边形顶点的颜色可以由纹理颜色和光照颜色决定
</div>
<div style>
const D3DXCOLOR      WHITE( D3DCOLOR_XRGB(255, 255, 255) );
</div>
<div style>
 const D3DXCOLOR     YELLOW( D3DCOLOR_XRGB(255, 255,   0) );
</div>
<div style>
 D3DXVECTOR3 lightDir(0.0f, 0.0f, 1.0f);
</div>
<div style>
 D3DXCOLOR lightColor = D3DCOLOR_XRGB(255, 255, 255);
</div>
<div style>
 D3DLIGHT9 light = d3d::InitDirectionalLight(&amp;lightDir, &amp;lightColor);
</div>
<div style>
 D3DMATERIAL9 matrial = d3d::InitMtrl(YELLOW, YELLOW, YELLOW, BLACK, 2.0f);
</div>
<div style>
 // 使用这样的环境光颜色，会导致绘制异常
</div>
<div style>
 //Device-&gt;SetRenderState(D3DRS_AMBIENT, 0x00808080);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
/*可指定漫反射光的来源，可以来自材质D3DMCS_MATERIAL，顶点漫反射颜色 D3DMCS_COLOR1，顶点镜面反射颜色 D3DMCS_COLOR2<br>
<span> </span><br>
<span style="background-color:inherit; line-height:1.5"> 默认是来自于D3DMCS_COLOR1，一般默认就好了 </span>
</div>
<div style>
*/
</div>
<div style>
 Device-&gt;SetRenderState(D3DRS_DIFFUSEMATERIALSOURCE,<br>
<span> </span><br>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">D3DMCS_MATERIAL</span>);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 // 开启光照下面4个都要设置
</div>
<div style>
 Device-&gt;SetRenderState(D3DRS_LIGHTING, true);// 默认为true,不需要记得关闭
</div>
<div style>
 Device-&gt;SetMaterial(&amp;matrial);
</div>
<div style>
 Device-&gt;SetLight(0, &amp;light);
</div>
<div style>
 Device-&gt;LightEnable(0, TRUE);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
// 额外的光照设置，这里不用也是可以的
</div>
<div style>
 /*Device-&gt;SetRenderState(D3DRS_NORMALIZENORMALS, true);
</div>
<div style>
 Device-&gt;SetRenderState(D3DRS_SPECULARENABLE, false);*/
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3><strong style="background-color:inherit">3.黑暗纹理用光照贴图模拟像素光照</strong></h3>
</div>
<div style>
因为光源很接近物体时候会导致顶点没有光照而使得三角形内没有光照，所以需要基于像素的光照因为逐像素计算光照计算量太大，所以需要用光照贴图来代替光照。
</div>
<div style>
<strong style="background-color:inherit">// 背景纹理</strong>
</div>
<div style>
<span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTexture(0, g_base_texture);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, 0);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit"><br style="background-color:inherit"> // 光照纹理和背景纹理，进行<span style="font-family:微软雅黑; font-size:14px; color:#04080; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">D3DTOP_MODULATE分量乘法计算，得到黑暗纹理</span><br style="background-color:inherit"> pd3dDevice-&gt;SetTexture(1, g_dark_texture);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_TEXCOORDINDEX, 0);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLORARG1, D3DTA_TEXTURE);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLORARG2, D3DTA_CURRENT);<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);</span><br>
<br style="background-color:inherit">
</div>
<div style>
<span style="color:#004080; background-color:inherit"><br style="background-color:inherit"> </span>
</div>
<div style>
<h3><span style="color:#004080; background-color:inherit"><strong style="background-color:inherit">4. 黑暗纹理动画，通过不同的分量相乘作为结果输出,也可以用不同的纹理算法和状态间切换实现特效</strong></span></h3>
</div>
<div style>
<span style="color:#c00000; background-color:inherit">// 1.切换纹理阶段融合的算法</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">static double interval = 0.0f;</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  interval += 0.0015f;</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  char szBuffer[256];</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  sprintf(szBuffer, “interval: %1.4f\n”, interval);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  OutputDebugString(szBuffer);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  if(interval &lt; 0.5f)</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  else if(interval &gt; 0.5f &amp;&amp; interval &lt; 1.0f)</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   // D3DTOP_MODULATE2X是分量相乘后得到的颜色左移1位作为最终颜色</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE2X);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  else if(interval &gt; 1.0f &amp;&amp; interval &lt; 1.5f)</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   // D3DTOP_MODULATE2X是分量相乘后得到的颜色左移2位作为最终颜色</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE4X);</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">  if(interval &lt; 0.0f || interval &gt; 1.5f)</span>
</div>
<div style>
<span style="color:#004080; background-color:inherit">   interval = timeDelta;</span>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3><strong style="background-color:inherit">5.实现黑暗环境中灯光开灯闪烁效果</strong></h3>
</div>
<div style>
这个过程可以描述为”（基础贴图 x 顶点的漫反射颜色） x 黑暗贴图”。可以从没有光照中切换到有光照中出现灯光，再通过设置1阶段和0阶段纹理的融合方式从分量乘法变为加法实现全部照明，来模拟开灯效果。<br>
<br style="background-color:inherit">
</div>
<div style>
// 1.设置阶段纹理
</div>
<div style>
Device-&gt;SetTexture(0, BackTex);
</div>
<div style>
 // D3DTOP_MODULATE分量乘法
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_MODULATE);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG2, D3DTA_DIFFUSE);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_DISABLE);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, 0);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 // set color blend operation and texture coordinate index for texture stage 1
</div>
<div style>
 Device-&gt;SetTexture(1, LightTex);
</div>
<div style>
 // D3DTOP_MODULATE分量乘法
</div>
<div style>
 Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);
</div>
<div style>
 Device-&gt;SetTextureStageState(1, D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
 Device-&gt;SetTextureStageState(1, D3DTSS_COLORARG2, D3DTA_CURRENT);
</div>
<div style>
 Device-&gt;SetTextureStageState(1, D3DTSS_ALPHAOP, D3DTOP_DISABLE);
</div>
<div style>
 Device-&gt;SetTextureStageState(1, D3DTSS_TEXCOORDINDEX, 0);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 Device-&gt;SetSamplerState(1, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(1, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);
</div>
<div style>
 Device-&gt;SetSamplerState(1, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
// 2. 材质设置和光照启用
</div>
<div style>
D3DXVECTOR3 lightDir(0.0f, 0.0f, 1.0f);
</div>
<div style>
 D3DXCOLOR lightColor = D3DCOLOR_XRGB(128, 128, 128);
</div>
<div style>
 D3DLIGHT9 light = d3d::InitDirectionalLight(&amp;lightDir, &amp;lightColor);
</div>
<div style>
 D3DMATERIAL9 matrial = d3d::InitMtrl(WHITE, WHITE * 0.7f, BLACK, BLACK, 0.0f);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
Device-&gt;SetRenderState(D3DRS_LIGHTING, true);
</div>
<div style>
 Device-&gt;SetMaterial(&amp;matrial);
</div>
<div style>
 Device-&gt;SetLight(0, &amp;light);
</div>
<div style>
 Device-&gt;LightEnable(0, TRUE);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
// 3.Display每帧渲染函数中切换有光照和没光照
</div>
<div style>
static int nFrameTime = 0;
</div>
<div style>
  if( nFrameTime &lt; 1000 )
</div>
<div style>
  {
</div>
<div style>
   Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">// 光照黑暗效果</span><br>
<br style="background-color:inherit">
</div>
<div style>
   Device-&gt;SetRenderState(D3DRS_LIGHTING, TRUE);
</div>
<div style>
  }
</div>
<div style>
  else if (nFrameTime &lt; 2000)
</div>
<div style>
  {
</div>
<div style>
    // 光照黑暗效果
</div>
<div style>
   Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_MODULATE);
</div>
<div style>
   Device-&gt;SetRenderState(D3DRS_LIGHTING, FALSE);
</div>
<div style>
  }
</div>
<div style>
  else if (nFrameTime &lt; 3000)
</div>
<div style>
  {
</div>
<div style>
    // 光照发光效果
</div>
<div style>
 <br>
<span> </span><br>
<span style="color:#c00000; background-color:inherit"> Device-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_ADD);</span>
</div>
<div style>
  }
</div>
<div style>
  nFrameTime++;
</div>
<div style>
  if( nFrameTime &gt;= 3000)
</div>
<div style>
  {
</div>
<div style>
   nFrameTime = 0;
</div>
<div style>
  }
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3><strong style="background-color:inherit">6.细节纹理</strong></h3>
</div>
<div style>
细节纹理，在第后面阶层纹理，用<br>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">D3DTOP_ADDSIGNED纹理操作算法。</span>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"></span>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
 /*D3DTOP_ADDSIGNED
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
 color rgba = arg1 + arg2 – 0.5
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
  Add the components of the arguments with a – 0.5 bias,
</div>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
  making the effective range of values from – 0.5 through 0.5. */
</div>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">它将参数的每个成分相加后再减去偏移量0.5，在细节贴图中较亮的灰色纹理元素会使基础贴图变得更亮，而较暗的灰色纹理元素会使基础贴图变得更暗。由此可使物体呈现出粗糙的表面，从而使之看上去更为真实。<br style="background-color:inherit"> </span>
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><br style="background-color:inherit"> </span>
</div>
<div style>
Device-&gt;SetTexture(0, BackTex);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, 0);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 Device-&gt;SetTexture(1, DetailTex);
</div>
<div style>
 Device-&gt;SetTextureStageState(1,D3DTSS_TEXCOORDINDEX, 0);
</div>
<div style>
 Device-&gt;SetTextureStageState(1,D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
 Device-&gt;SetTextureStageState(1,D3DTSS_COLORARG2, D3DTA_CURRENT);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 if( FAILED( Device-&gt;SetTextureStageState( 1, D3DTSS_COLOROP, D3DTOP_ADDSIGNED )) )
</div>
<div style>
 {
</div>
<div style>
  Device-&gt;SetTextureStageState( 1, D3DTSS_COLOROP, D3DTOP_MODULATE2X );
</div>
<div style>
 }
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3><strong style="background-color:inherit">7.纹理阶层的Alpha混合操作</strong></h3>
</div>
<div style>
// alpha来源设置
</div>
<div style>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#800000; background-color:inherit">如果要从一张纹理中获取Alpha值，应将D3DTA_TEXTURE作为Alpha参数。<br style="background-color:inherit"> 如果要使用来自顶点中的Alpha值，应将D3DTA_DIFFUSE作为Alpha参数，并确保渲染状态D3DRS_DIFFUSEMATERIALSOURCE被设置为D3DMCS_COLOR1（这也是默认状态）。</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#800000; background-color:inherit">如果要使用来自材质中的Alpha值，应将D3DTA_DIFFUSE作为Alpha参数，并确保渲染状态D3DRS_DIFFUSEMATERIALSOURCE被设置为D3DMCS_MATERIAL。</span></p>
<p style="margin:5px 0px; background-color:inherit">如果未用SetRenderState()设置D3DRS_DIFFUSEMATERIALSOURCE参数，则从默认来源（即顶点）获取漫反射颜色。</p>
<p style="margin:5px 0px; background-color:inherit"><br style="background-color:inherit"> </p>
<p style="margin:5px 0px; background-color:inherit">//设置纹理颜色和光照顶点颜色进行融合</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTexture( 0, g_pTexture );</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_TEXCOORDINDEX, 0 );</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_COLORARG1, D3DTA_TEXTURE );</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_COLORARG2, D3DTA_DIFFUSE );</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_COLOROP,   D3DTOP_MODULATE );</p>
<p style="margin:5px 0px; background-color:inherit">// 选择纹理alpha作为第0阶层纹理的颜色，这里也就是多边形顶点颜色的alpha值</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE );</p>
<p style="margin:5px 0px; background-color:inherit"> Device-&gt;SetTextureStageState( 0, D3DTSS_ALPHAOP,   D3DTOP_SELECTARG1 );</p>
<p style="margin:5px 0px; background-color:inherit"><br style="background-color:inherit"> </p>
<p style="margin:5px 0px; background-color:inherit"> //Alpha混合设置, 设置混合系数</p>
<p style="margin:5px 0px; background-color:inherit"> pd3dDevice-&gt;SetRenderState( D3DRS_ALPHABLENDENABLE,   true );</p>
<p style="margin:5px 0px; background-color:inherit"> pd3dDevice-&gt;SetRenderState( D3DRS_SRCBLEND,  D3DBLEND_SRCALPHA );</p>
<p style="margin:5px 0px; background-color:inherit"> pd3dDevice-&gt;SetRenderState( D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA );</p>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h2><strong style="background-color:inherit">Texture Wrapping纹理包装</strong></h2>
</div>
<div style>
影响纹理光栅化时候的插值，说明究竟是默认直线插值，还是沿着UV进行曲线插值计算像素纹理坐标：
</div>
<div style>
// D3DRS_WRAP0是指第0阶层纹理，D3DWRAPCOORD_0就是D3DWRAP_U，D3DWRAPCOORD_1是D3DWRAP_V方向
</div>
<div style>
 // 这里是指对第0层纹理采用UV方向都进行曲线空间包装类型的插值，而不是两点间直线插值。
</div>
<div style>
 // 要禁用纹理包装类型的插值，那么SetRenderState( D3DRS_WRAP0, 0)即可，默认也是0值的。
</div>
<div style>
 // 只有空间物体环境纹理中，才会用到纹理包装，否则平面内使用纹理包装会导致着色异常。
</div>
<div style>
 //Device-&gt;SetRenderState( D3DRS_WRAP0, D3DWRAPCOORD_0 /*| D3DWRAPCOORD_1 */);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h2><strong style="background-color:inherit">CubeMapTexture立方体纹理映射和球形纹理映射实现<strong style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left">环境纹理</strong></strong></h2>
</div>
<div style>
<strong style="background-color:inherit">自动生成纹理坐标和自动纹理坐标变换，用于<strong style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left">立方体纹理映射和球形纹理映射。</strong></strong>
</div>
<div style>
<strong style="background-color:inherit">和普通纹理的区别就是使用自动纹理坐标，和指定uv纹理坐标用顶点<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">法线作为uv坐标</span>，还是球形的。</strong>
</div>
<div style>
<p style="margin:5px 0px; background-color:rgb(255,255,255); font-weight:normal; color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"> 一般应用：</p>
<p style="margin:5px 0px; background-color:rgb(255,255,255); font-weight:normal; font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"> <span style="color:#c00000; background-color:inherit">用于天空盒贴图。</span></p>
<p style="margin:5px 0px; background-color:rgb(255,255,255); font-weight:normal; font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"> <span style="color:#c00000; background-color:inherit">用于物体反射周围环境颜色。</span></p>
<h3 style="margin:5px 0px; background-color:rgb(255,255,255); font-weight:normal; font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"> <span style="color:#c00000; background-color:inherit"><strong>球形环境纹理</strong><br> </span></h3>
<p> 基础设置：
</p></div>
<div style>
Device-&gt;SetTexture(0, BackTex);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_TEXCOORDINDEX, 0);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);
</div>
<div style>
 Device-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);
</div>
<div style>
 Device-&gt;SetTextureStageState( 0, D3DTSS_ALPHAOP,   D3DTOP_DISABLE );
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<strong style="background-color:inherit">1)利用摄影机空间顶点位置生成纹理坐标，自动生成纹理坐标不需要顶点中包含纹理坐标信息</strong>
</div>
<div style>
 // 自动生成纹理坐标只适合在一些特殊效果上，所以大多数情况下顶点还是要包含纹理坐标信息的
</div>
<div style>
 // 自动生成，一般情况下只用在环境纹理上
</div>
<div style>
 Device-&gt;SetTextureStageState( 0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_CAMERASPACEPOSITION/*D3DTSS_TCI_SPHEREMAP*/);
</div>
<div style>
 // 控制纹理坐标自动生成的格式标识，一般是二维的
</div>
<div style>
 Device-&gt;SetTextureStageState( 0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2 );
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<strong style="background-color:inherit">2)纹理坐标变换只能应用于自动生成的纹理坐标中，变换矩阵和顶点的矩阵一样</strong>
</div>
<div style>
 D3DXMATRIXA16 matTex, matScale, matTrans;
</div>
<div style>
 D3DXMatrixIdentity(&amp;matTex);
</div>
<div style>
 D3DXMatrixScaling(&amp;matScale, 0.5f, -0.5f, 1.0f);
</div>
<div style>
 D3DXMatrixTranslation(&amp;matTrans, 0.5f, 0.5f, 1.0f);
</div>
<div style>
 matTex = matTex * matScale * matTrans;
</div>
<div style>
// 坐标系和D3DTS_WORLD,D3DTS_VIEW,D3DTS_PROJECTION一样，纹理坐标有D3DTS_TEXTURE0~D3DTS_TEXTURE7
</div>
<div style>
 Device-&gt;SetTransform( D3DTS_TEXTURE0, &amp;matTex );
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
//设置球形环境映射纹理
</div>
<div style>
 pd3dDevice-&gt;SetTexture( 0, g_pEnvTexture);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //设置纹理坐标自动生成
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_SPHEREMAP );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2 );
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //设计纹理阶段混合状态
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLORARG2, D3DTA_DIFFUSE );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLORARG1, D3DTA_TEXTURE );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLOROP,   D3DTOP_MODULATE );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_ALPHAOP,   D3DTOP_DISABLE);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<strong style="background-color:inherit">3)自动纹理坐标生成应用最为广泛的环境纹理映</strong>
</div>
<div style>
环境纹理映射，就是将周围环境在光滑三维物体上的映像，用一幅贴图描绘出来，然后映射到物体表面，其实就是简单的映射，唯一不同就是用了自动生成纹理坐标，且这里没有使用自动生成纹理坐标转换。
</div>
<div style>
//设置球形环境映射纹理
</div>
<div style>
 pd3dDevice-&gt;SetTexture( 0, g_pEnvTexture);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //设置纹理坐标自动生成
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_SPHEREMAP );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2 );
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //设计纹理阶段混合状态
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLORARG2, D3DTA_DIFFUSE );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLORARG1, D3DTA_TEXTURE );
</div>
<div style>
// 用分量乘法，将物体表面顶点漫反射和当前的环境纹理融合
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_COLOROP,   D3DTOP_MODULATE );
</div>
<div style>
 pd3dDevice-&gt;SetTextureStageState( 0, D3DTSS_ALPHAOP,   D3DTOP_DISABLE);
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h3>CubeMapTexture立方体纹理</h3>
</div>
<div style>
立方体纹理是一种特殊的纹理技术，它用6幅二维纹理图像构成一个以原点为中心的纹理立方体。对于每个片段，纹理坐标(s, t, r)被当作方向向量看待，每个纹理单元都表示从原点所看到的纹理立方体上的图像。<br>
<br style="background-color:inherit">
</div>
<div style>
<span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">它有6个面，每个面都是一个二维图像，每个二维图像用一个x,-x, y, -y, z, -z来表示。</span><br>
<br style="background-color:inherit">
</div>
<div style>
OGL中指定六个面的方式：
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5">imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image1);  </span><br>
<br style="background-color:inherit"><br>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_X, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5">imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image4);  </span><br>
<br style="background-color:inherit"><br>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_Y, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5"> imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image2);  </span><br>
<br style="background-color:inherit"><br>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5"> imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image5);  </span><br>
<br style="background-color:inherit"><br>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_Z, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5">imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image3);  </span><br>
<br style="background-color:inherit"><br>
<span style="background-color:inherit; line-height:1.5">glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, GL_RGBA,  </span><br>
<span style="background-color:inherit; line-height:1.5">imageSize, imageSize, 0, GL_RGBA, GL_UNSIGNED_BYTE, image6);  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">指定立方体纹理对象的参数：<br style="background-color:inherit"> </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S,  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">                GL_REPEAT);  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T,  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">                GL_REPEAT);  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R,  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">                GL_REPEAT);  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER,  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">                GL_NEAREST);  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER,  </span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">                GL_NEAREST);</span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">纹理纹素的获取算法</span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">          正如前面所述，对于每个片段，纹理坐标(s, t, r)被当作方向向量看待，每个纹理单元都表示从原点所看到的纹理立方体上的图像。参见实现代码来自mesa3d里面，源文件路径为Mesa-8.0.4\src\mesa\swrast\s_texfilter.c</span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">应用立体纹理时候，还需要指定：</span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5">使用vertex的法线作为uv坐标；   (GL_NORMAL_MAP)</span>
</div>
<div style>
<span style="background-color:inherit; line-height:1.5"></span>
<div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
<p style="margin:5px 0px; background-color:inherit">用于天空盒贴图。</p>
<p style="margin:5px 0px; background-color:inherit">使用法线和相机到vertex的向量，推导出入射光向量作为uv坐标 (GL_REFLECTION_MAP)</p>
<p style="margin:5px 0px; background-color:inherit">用于物体反射周围环境颜色。</p>
<p style="margin:5px 0px; background-color:inherit">然后自动或者手动shader计算立体纹理uv坐标，然后渲染物体就可以了。</p>
</div>
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
<h2><strong style="background-color:inherit">bumpTexture凹凸纹理映射</strong></h2>
</div>
<div style>
普通的纹理映射只能模拟比较平滑的三维物体表面，难以显示表面高低起伏、凹凸不平的效果。凹凸纹理映射能够通过一张表示物体表面凹凸程度的高度图（称为凹 凸纹理），对另一张表示物体表面环境映射的纹理图的纹理坐标进行相应的干扰，经过干扰的纹理坐标将应用于环境映射，从而产生凹凸不平的显示效果。凹凸纹理 映射通常由三张纹理映射图组成，第一张纹理图表示物体表面原始纹理颜色，第二张凹凸纹理图表示物体表面凹凸的高度起伏值，用来对下一张环境纹理图坐标进行 干扰，第三张纹理图表示周围镜面反射或漫反射光照的环境光照映射图。<br>
<br style="background-color:inherit">
</div>
<div style>
<strong style="background-color:inherit">1) 检测设备是否支持凹凸纹理</strong>
</div>
<div style>
bool CALLBACK IsDeviceAcceptable( D3DCAPS9* pCaps, D3DFORMAT AdapterFormat,
</div>
<div style>
 D3DFORMAT BackBufferFormat, bool bWindowed,
</div>
<div style>
 void* pUserContext )
</div>
<div style>
{
</div>
<div style>
 //检查后台缓冲区格式是否支持Alpha混合等操作(post pixel blending operations)
</div>
<div style>
 IDirect3D9* pD3D = d3d::d3d9;
</div>
<div style>
 if( FAILED( pD3D-&gt;CheckDeviceFormat( pCaps-&gt;AdapterOrdinal, pCaps-&gt;DeviceType,
</div>
<div style>
  AdapterFormat, D3DUSAGE_QUERY_POSTPIXELSHADER_BLENDING,
</div>
<div style>
  D3DRTYPE_TEXTURE, BackBufferFormat ) ) )
</div>
<div style>
  return false;
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //检查当前设备是否支持凹凸纹理
</div>
<div style>
 if(0 == (pCaps-&gt;TextureOpCaps&amp;(D3DTEXOPCAPS_BUMPENVMAP|D3DTEXOPCAPS_BUMPENVMAPLUMINANCE)))
</div>
<div style>
  return false;
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //检查当前设备是否支持3层纹理混合
</div>
<div style>
 if(pCaps-&gt;MaxTextureBlendStages &lt; 3)
</div>
<div style>
  return false;
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 //检查当前设备是否支持设置的凹凸纹理像素格式
</div>
<div style>
 if( FAILED( pD3D-&gt;CheckDeviceFormat( pCaps-&gt;AdapterOrdinal, pCaps-&gt;DeviceType,
</div>
<div style>
  AdapterFormat, D3DUSAGE_QUERY_LEGACYBUMPMAP,  
</div>
<div style>
  D3DRTYPE_TEXTURE, D3DFMT_X8L8V8U8 ) ) )
</div>
<div style>
  return false;
</div>
<div style>
<br style="background-color:inherit">
</div>
<div style>
 return true;
</div>
<div style>
}
</div>
<div style>
<strong style="background-color:inherit">2) <span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left">凹凸纹理的生成</span></strong>
</div>
<div style>
<p style="margin:5px 0px; background-color:inherit">Direct3D的凹凸纹理被用来表示物体表面相邻像素的高度差，它的每个纹理元素由表示水平相邻像素高度差的D<sub style="background-color:inherit">u</sub>、表示垂直相邻像素高度差的D<sub style="background-color:inherit">v</sub>以及表示该点亮度的L组成（某些凹凸纹理像素格式可以不包含L）。下表列出了Direct3D支持的凹凸纹理像素格式：</p>
<table border="1" cellpadding="2" cellspacing="0" width="100%" style="font-size:undefined; border-collapse:collapse; margin-top:10px; margin-bottom:10px; display:table; background-color:inherit">
<tbody style="background-color:inherit">
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt"><strong style="background-color:inherit">凹凸纹理像素格式</strong></span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt"><strong style="background-color:inherit">说明</strong></span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_V8U8</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">每个像素由16位整数表示，分别由8位整数表示D<sub style="background-color:inherit">u</sub>和D<sub style="background-color:inherit">v</sub></span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_L6V5U5</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">每个像素由16位整数表示，6位整数表示L，分别由5位整数表示D<sub style="background-color:inherit">u</sub>和D<sub style="background-color:inherit">v</sub></span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_X8L8V8U8</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">每个像素由32位整数表示，包括8位保留位、8位L、8位D<sub style="background-color:inherit">u</sub>、8位D<sub style="background-color:inherit">v</sub></span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_V16U16</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">每个像素由32位整数表示，分别由16位整数表示D<sub style="background-color:inherit">u</sub>和D<sub style="background-color:inherit">v</sub></span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_Q8W8V8U8</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">每个像素由32位整数表示，分别由8位整数表示Q、W、V、U</span></td>
</tr>
<tr style="background-color:inherit">
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">D3DFMT_CxV8U8</span></td>
<td style="word-break:break-all; border:1px solid rgb(153,153,153); padding:5px 16px 5px 12px; min-height:25px; min-width:25px; height:25px; background-color:inherit"> <span style="font-family:微软雅黑; color:#3c3c3c; background-color:inherit; font-size:11pt">压缩像素格式，每个像素由16位整数表示，即8位D<sub style="background-color:inherit">u</sub>和8位D<sub style="background-color:inherit">v</sub>，另外C = sqrt(1 – D<sub style="background-color:inherit">u</sub><sup style="background-color:inherit">2</sup><span> </span>– D<sub style="background-color:inherit">v</sub><sup style="background-color:inherit">2</sup>  )</span></td>
</tr>
</tbody>
</table>
<p style="margin:5px 0px; background-color:inherit">通常情况下，可以载入一张表示物体表面图像高度的纹理图，通过计算高度图水平相邻和垂直相邻元素的高度差来生成凹凸纹理，也可以通过程序生成凹凸纹理，这里根据高度纹理图，用程序来生成凹凸纹理，代码如下：</p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">HRESULT CreateBumpTexture(IDirect3DDevice9* device, IDirect3DTexture9* pHeightMapTexture, IDirect3DTexture9* pBump_map_texture)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	HRESULT hr;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	D3DSURFACE_DESC surface_desc;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// pHeightMapTexture是高度纹理图，每个像素存放的是高度，虽然大小是4个字节，但是只用一个字节也就是大小为[0,255]
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// 从纹理的表面数据中获取纹理的具体数值
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	pHeightMapTexture-&gt;GetLevelDesc(0, &amp;surface_desc);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// 创建一个凹凸纹理图，凹凸纹理的每个像素存放的是D3DFMT_X8L8V8U8,
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// 值为：预留值X8、亮度值L8、相邻上高度减去下高度的值V8、左高度减去右高度的值U8
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	device-&gt;CreateTexture(surface_desc.Width, surface_desc.Height, 1, 0, D3DFMT_X8L8V8U8, D3DPOOL_MANAGED,
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		&amp;pBump_map_texture, NULL);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	D3DLOCKED_RECT locked_rect;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	pHeightMapTexture-&gt;LockRect(0, &amp;locked_rect, NULL, 0);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// 一行的宽度
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	DWORD src_pitch   = (DWORD) locked_rect.Pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	BYTE* src_row_top = (BYTE*) locked_rect.pBits;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	BYTE* src_row_cur = src_row_top;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	BYTE* src_row_bot = src_row_top + src_pitch * (surface_desc.Height - 1);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	pBump_map_texture-&gt;LockRect(0, &amp;locked_rect, NULL, 0);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	DWORD dest_pitch   = (DWORD) locked_rect.Pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	BYTE* dest_row_top = (BYTE*) locked_rect.pBits;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	BYTE* dest_row_cur = dest_row_top;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	// iterate through all lines
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	for(DWORD y = 0; y &lt; surface_desc.Height; y++)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 源像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		BYTE* src_pixel_cur;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 源上一行的像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		BYTE* src_pixel_up;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 源下一行的像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		BYTE* src_pixel_below;		
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 目标像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		BYTE* dest_pixel;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 取当前行做为源像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		src_pixel_cur = src_row_cur;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 当y为0第一行时候，源像素的上一行为最后一行像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		if(y == 0)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_up = src_row_bot;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 否则上一行的像素等于当前行的像素减去一行的宽度
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		else
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		    src_pixel_up = src_row_cur - src_pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 最末一行的下一行像素，是第一行像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		if(y == surface_desc.Height - 1)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_below = src_row_top;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 否则下一行像素，等于当前行加上行宽
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		else
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_below = src_row_cur + src_pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 目标行等于当前目标行
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		dest_pixel = dest_row_cur;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// iterate through all columns in current line
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		for(DWORD x = 0; x &lt; surface_desc.Width; x++)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		{
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			BYTE src_pixel_left, src_pixel_right;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			if(x == 0)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				// 第0列，左边一个像素等于最后一个像素，4个字节等于D3DFMT_X8L8V8U8大小
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				src_pixel_left = *(src_row_cur + (surface_desc.Width - 4));
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			else
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				// 其它列，左边一个像素就是当前像素减去4个字节等于D3DFMT_X8L8V8U8大小
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				src_pixel_left = *(src_pixel_cur - 4);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			if(x == surface_desc.Width - 1)
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				// 最后一列，右边一个像素等于第一列的像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				src_pixel_right = *src_row_cur;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			else
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				// 其它像素等于，右边一个像素
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">				src_pixel_right = *(src_pixel_cur + 4);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// du是当前像素的左边第一个像素高度值(小端存储)，减去右边一个像素的高度值
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			BYTE du = BYTE(src_pixel_left - src_pixel_right);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// dv是当前像素列的上一列减去下一列的高度值
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			BYTE dv = BYTE(src_pixel_up   - src_pixel_below);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// the luminance bump value
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 目标当前行中的迭代像素值(高度)，如果大于1那么亮度取63，否则取127
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			BYTE u_lumi = (*src_pixel_cur &gt; 1) ? 63 : 127;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 一个4字节的数值里面，格式为D3DFMT_X8L8V8U8,低数值存放在低地址，所以是先赋值du
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			*dest_pixel++ = du;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			*dest_pixel++ = dv;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			*dest_pixel++ = u_lumi;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			*dest_pixel++ = 0;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// move one pixel to the right
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 当前源像素跳过4字节
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_cur   += 4;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 源的下一行加上了4字节
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_below += 4;	
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 源的上一行也应该加4字节[by jiayuan 2015.8.2]
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_up +=4;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			// 当前目标像素跳过4字节
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">			src_pixel_up     += 4;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// move to the next line
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 一行结束，源像素行加宽度
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		src_row_cur  += src_pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		// 一行结束，目标像素加宽度
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">		dest_row_cur += dest_pitch;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	}
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	pBump_map_texture-&gt;UnlockRect(0);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	pHeightMapTexture-&gt;UnlockRect(0);
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	return S_OK;
</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">}</span></pre>
<p> 3) <br>
<strong style="background-color:inherit; line-height:1.5">凹凸纹理设置</strong> </p>
<p style="margin:5px 0px; background-color:inherit">凹凸纹理映射通常使用3层纹理：物体原始纹理、由原始纹理高度图生成的凹凸纹理、环境纹理，对应于多层纹理混合的0、1、2层。指定当前纹理层状态 为D3DTOP_BUMPENVMAP或D3DTOP_BUMPENVMAPLUMINANCE可设置当前纹理层为凹凸纹理，例如：</p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTexture(1, g_bump_map_texture);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">// </span><span style="color:#04080; background-color:inherit; line-height:1.5">D3DTOP_BUMPENVMAP 没有亮度值，默认设置为1，和下一阶层纹理分量乘法输出是下一阶层的颜色</span><span style="color:#004080; background-color:inherit"><br style="background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLOROP,		   D3DTOP_BUMPENVMAP);</span></pre>
<p style="margin:5px 0px; background-color:inherit">或</p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTexture(1, g_bump_map_texture);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">// </span><span style="color:#04080; background-color:inherit; line-height:1.5">D3DTOP_BUMPENVMAPLUMINANCE 有亮度值需要和下阶层分量乘法输出颜色</span><span style="color:#004080; background-color:inherit"><br style="background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLOROP,		   D3DTOP_BUMPENVMAPLUMINANCE);</span></pre>
<p style="margin:5px 0px; background-color:inherit">纹理状态D3DTOP_BUMPENVMAP和D3DTOP_BUMPENVMAPLUMINANCE表示两种不同的凹凸纹理映射方法。纹理状态D3DTOP_BUMPENVMAPLUMINANCE表示在凹凸纹理中包含凹凸纹理亮度值L，L将与下一纹理层的纹理颜色相乘作为最后输出的纹理颜色。纹理状态D3DTOP_BUMPENVMAP默认亮度值L为1，即不改变下一纹理层的纹理颜色。</p>
<p style="margin:5px 0px; background-color:inherit"><br style="background-color:inherit"> </p>
<p style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">4) 凹凸纹理的扰动矩阵和亮度系数亮度偏移的设置</strong></p>
<p style="margin:5px 0px; background-color:inherit">Direct3D可设置凹凸纹理矩阵，对凹凸纹理中的每个纹理元素值（D<sub style="background-color:inherit">v</sub>、D<sub style="background-color:inherit">u</sub>，即对于下一纹理层中的每个纹理坐标的扰动值）进行坐标变换：</p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#004080; background-color:inherit">D<sub style="background-color:inherit">u</sub>‘ = D<sub style="background-color:inherit">u</sub><span> </span>* M<sub style="background-color:inherit">00</sub><span> </span>+ D<sub style="background-color:inherit">v</sub><span> </span>* M<sub style="background-color:inherit">10</sub></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#004080; background-color:inherit">D<sub style="background-color:inherit">v</sub>‘ = D<sub style="background-color:inherit">v</sub><span> </span>* M<sub style="background-color:inherit">01</sub><span> </span>+ D<sub style="background-color:inherit">v</sub><span> </span>* M<sub style="background-color:inherit">11</sub></span></p>
<p style="margin:5px 0px; background-color:inherit">凹凸纹理的每个纹理元素D<sub style="background-color:inherit">v</sub>、D<sub style="background-color:inherit">u</sub>与一个2 x 2的凹凸矩阵相乘，其结果D<sub style="background-color:inherit">v</sub>、D<sub style="background-color:inherit">u</sub>对下一纹理层中的每个纹理元素的纹理坐标产生该数值代表的坐标扰 动。2 x 2的凹凸矩阵值可由函数IDirect3DDevice9::SetTextureStageState()设置，将它的第一个参数设置为纹理层序号，第 二个参数设置为D3DTSS_BUMPENVMAT00或D3DTSS_BUMPENVMAT01或D3DTSS_BUMPENVMAT10或 D3DTSS_BUMPENVMAT11，分别表示凹凸矩阵的4个矩阵元素，第三个参数设置为该矩阵元素的值。纹理坐标扰动D<sub style="background-color:inherit">v</sub>、D<sub style="background-color:inherit">u</sub>或D<sub style="background-color:inherit">v</sub>‘、D<sub style="background-color:inherit">u</sub>‘的范围介于-1 ~ +1之间。</p>
<p style="margin:5px 0px; background-color:inherit">如果使用D3DTOP_BUMPENVMAPLUMINANCE计算凹凸纹理，Direct3D将使用下列方程计算凹凸纹理的亮度值L’（L’为0~255的整数，它将被用来与下一纹理层的颜色相乘，作为最后输出的纹理颜色值）。</p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#004080; background-color:inherit">L’ = L * S + O</span></p>
<p style="margin:5px 0px; background-color:inherit">其中，L为凹凸纹理元素中的亮度L值，比例系数S和偏移系数O可改变最终的亮度值。S和O可由函数 IDirect3DDevice9::SetTexureStageState()设置，将它的第一个参数设置为纹理层序号，第二个参数设置为 D3DTSS_BUMPENVLSCALE或D3DTSS_BUMPENVLOFFSET，分别表示凹凸纹理映射的比例系数S和偏移系数O，将第三个参数 设置为相应的系数值。</p>
<p style="margin:5px 0px; background-color:inherit">设置凹凸纹理状态的代码如下所示：</p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#004080; background-color:inherit">// set texture color blend method for stage 0 (base texture)</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE);<span> </span></span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);<span> </span></span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">// set texture color blend method for stage 1 (bump map texture)</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTexture(1, g_bump_map_texture);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(</span><span style="color:#c00000; background-color:inherit">1, D3DTSS_TEXCOORDINDEX, 0</span><span style="color:#004080; background-color:inherit">);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLOROP, D3DTOP_BUMPENVMAPLUMINANCE);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLORARG1, D3DTA_TEXTURE);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_COLORARG2, D3DTA_CURRENT);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVMAT00, F2DW(0.8f));<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVMAT01, F2DW(0.0f));<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVMAT10, F2DW(0.0f));<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVMAT11, F2DW(0.8f));</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVLSCALE, F2DW(4.0f));<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(1, D3DTSS_BUMPENVLOFFSET, F2DW(0.0f));</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(1, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(1, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">// set texture color blend method for stage 2 (environment map texture)</span><br style="background-color:inherit"> <br style="background-color:inherit"> <strong style="background-color:inherit">5）凹凸纹理使用环境纹理的话，那么需要设置环境纹理的自动纹理坐标，和自动纹理坐标转换矩阵</strong><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">D3DXMATRIX mat;</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">mat._11 = 0.5f; mat._12 = 0.0f; mat._13 = 0.0f; mat._14 = 0.0f;<span> </span></span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">mat._21 = 0.0f; mat._22 = -0.5f; mat._23 = 0.0f; mat._24 = 0.0f;<span> </span></span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">mat._31 = 0.0f; mat._32 = 0.0f; mat._33 = 1.0f; mat._34 = 0.0f;<span> </span></span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">mat._41 = 0.5f; mat._42 = 0.5f; mat._43 = 0.0f; mat._44 = 1.0f;<span> </span></span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTransform(D3DTS_TEXTURE2, &amp;mat);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTexture(2, g_env_map_texture);</span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(2, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_COUNT2);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#c00000; background-color:inherit">// 第0层第1层都是采用顶点uv或者用网格DrawSubset绘制，而第2阶层纹理采用了环境映射纹理用了自动生成坐标系<br style="background-color:inherit"> pd3dDevice-&gt;SetTextureStageState(2, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_SPHEREMAP);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(2, D3DTSS_COLORARG1, D3DTA_TEXTURE);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(2, D3DTSS_COLORARG2, D3DTA_CURRENT);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(2, D3DTSS_COLOROP, D3DTOP_ADD);<span> </span></span><br style="background-color:inherit"> <br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(2, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);</span><br style="background-color:inherit"> <span style="color:#004080; background-color:inherit">pd3dDevice-&gt;SetSamplerState(2, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);</span></p>
<p> <br style="background-color:inherit"> </p>
<h2 style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">volume texture立体纹理：每个维度都是有像素值的</strong></h2>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">// check whether device support volume texture<br style="background-color:inherit">if((pCaps-&gt;TextureCaps &amp; D3DPTEXTURECAPS_VOLUMEMAP) == 0)<br style="background-color:inherit">	return false;</span></pre>
<p style="margin:5px 0px; background-color:inherit">立体纹理（volume texture）是一组应用到二维图元（如一个三角形或一条直线）的三维纹理元素的集合，<span style="color:#c00000; background-color:inherit">可以使用立体纹理实现一些特殊效果，如迷雾、爆炸等</span>。当对一个图 元使用立体纹理时，它的每个顶点都需要一组三元纹理坐标。当绘制该图元时，它中间的每个像素都将用立体纹理中的一些纹理元素的颜色值进行填充，这与二维纹 理映射的情况相似。</p>
<p style="margin:5px 0px; background-color:inherit">立体纹理以薄片为单元组织起来，可以把它想象成将（宽 x 高）的二维表面转换成（宽 x 高 x 深）的三维立体，每个薄片是单独的一行，立体纹理可以有一系列级别，每一级都较上一级缩小一倍，<span style="color:#c00000; background-color:inherit">类似二维的多幅渐进纹理，只不过这里是三维的</span>。</p>
<p> <strong style="background-color:inherit">1) 声明顶点格式，使用立体纹理坐标</strong> </p>
<p style="margin:5px 0px; background-color:inherit">接着，我们需要在灵活顶点格式中指定每个顶点都需要三个纹理坐标，如下所示：</p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">struct sCustomVertex<br style="background-color:inherit">{<br style="background-color:inherit">	float x, y, z;</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">        // 一个立体纹理，是有x,y,z三个维度的，每个维度都是一个像素一层<br style="background-color:inherit">	float u, v, w;<br style="background-color:inherit">};</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">#define D3DFVF_CUSTOM_VERTEX	(D3DFVF_XYZ | D3DFVF_TEX1 | D3DFVF_TEXCOORDSIZE3(0))</span></pre>
<p style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">2) 填充顶点缓存，为了显示立体纹理在<strong style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left">不同深度上的表现</strong>，顶点纹理坐标的w值还是需要变化的</strong></p>
<p style="margin:5px 0px; background-color:inherit">接着，为每个顶点指定数据，创建顶点缓冲区并填充它：</p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(192,0,0)"><span style="color:#004080; background-color:inherit">// create vertex buffer and fill data</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(192,0,0)"><span style="color:#004080; background-color:inherit">sCustomVertex vertices[] = 	<br style="background-color:inherit">{<br style="background-color:inherit">    { -3.0f, -3.0f,  0.0f, 0.0f, 1.0f, 0.0f},<br style="background-color:inherit">    { -3.0f,  3.0f,  0.0f, 0.0f, 0.0f, 0.0f},<br style="background-color:inherit">    {  3.0f, -3.0f,  0.0f, 1.0f, 1.0f, 0.0f},<br style="background-color:inherit">    {  3.0f,  3.0f,  0.0f, 1.0f, 0.0f, 0.0f}<br style="background-color:inherit">};</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(192,0,0)"><span style="color:#004080; background-color:inherit">pd3dDevice-&gt;CreateVertexBuffer(sizeof(vertices), 0, D3DFVF_CUSTOM_VERTEX, D3DPOOL_MANAGED, &amp;g_vertex_buffer, NULL);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(192,0,0)"><span style="color:#004080; background-color:inherit">void* ptr;<br style="background-color:inherit">g_vertex_buffer-&gt;Lock(0, sizeof(vertices), (void**)&amp;ptr, 0);<br style="background-color:inherit">memcpy(ptr, vertices, sizeof(vertices));<br style="background-color:inherit">g_vertex_buffer-&gt;Unlock();</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(192,0,0)"><span style="color:#004080; background-color:inherit"></span><p style="margin:5px 0px; background-color:inherit">为了生成立体纹理，还必须改变纹理的w坐标：</p><pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">//--------------------------------------------------------------------------------------<br style="background-color:inherit">// Handle updates to the scene<br style="background-color:inherit">//--------------------------------------------------------------------------------------<br style="background-color:inherit">void CALLBACK OnFrameMove( IDirect3DDevice9* pd3dDevice, double fTime, float fElapsedTime, void* pUserContext )<br style="background-color:inherit">{<br style="background-color:inherit">	// change w coordinate of volume texture<br style="background-color:inherit"></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	float angle = (float) fTime / 2.0f;</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	sCustomVertex* ptr;</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	g_vertex_buffer-&gt;Lock(0, 0, (void**)&amp;ptr, 0);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">        // 改变w值，也就是w在[0,1]的纹理坐标内切换，显示立体纹理中不同维度的平面纹理</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	for(int i = 0; i &lt; 4; i++)<br style="background-color:inherit">		ptr[i].w = sin(angle) * sin(angle);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#004080; background-color:inherit">	g_vertex_buffer-&gt;Unlock();<br style="background-color:inherit">}</span></pre>
<p style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">3) 创建和填充立体纹理</strong></p>
<p style="margin:5px 0px; background-color:inherit">在示例程序中，立体纹理是由程序生成的，比较复杂。Direct3D提供了辅助函数D3DXCreateVolumeTextureFromFile()来从图片文件中生成立体纹理，该函数的声明如下：</p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#004040; background-color:inherit">Creates a volume texture from a file.</span></p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><strong style="background-color:inherit"><span style="color:#004040; background-color:inherit">HRESULT </span><span style="color:#c00000; background-color:inherit">D3DXCreateVolumeTextureFromFile</span><span style="color:#004040; background-color:inherit">(</span></strong><span style="color:#004040; background-color:inherit"><br style="background-color:inherit"></span><strong style="background-color:inherit; color:rgb(0,64,64)">LPDIRECT3DDEVICE9</strong><em style="background-color:inherit; color:rgb(0,64,64)">pDevice</em><strong style="background-color:inherit; color:rgb(0,64,64)">,</strong><span style="color:#004040; background-color:inherit"><br style="background-color:inherit"></span><strong style="background-color:inherit; color:rgb(0,64,64)">LPCTSTR</strong><em style="background-color:inherit; color:rgb(0,64,64)">pSrcFile</em><strong style="background-color:inherit; color:rgb(0,64,64)">,</strong><span style="color:#004040; background-color:inherit"><br style="background-color:inherit"></span><strong style="background-color:inherit; color:rgb(0,64,64)">LPDIRECT3DVOLUMETEXTURE9 *</strong><em style="background-color:inherit; color:rgb(0,64,64)">ppVolumeTexture</em><span style="color:#004040; background-color:inherit"><br style="background-color:inherit"></span><strong style="background-color:inherit; color:rgb(0,64,64)">);</strong></pre>
<p>   <span style="color:#800000; background-color:inherit">通过文件创建立体纹理时文件格式必须是立体纹理格式，对于普通格式的图片文件，可以通过DirectX提供的纹理工具”DirectX Texture Tool”转换成立体纹理格式的文件。</span> </p>
<p style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">程序创建立体纹理</strong></p>
<p style="margin:5px 0px; background-color:inherit">//创建立体纹理</p>
<p style="margin:5px 0px; background-color:inherit"> hr = pd3dDevice-&gt;CreateVolumeTexture( 16, 16, 16, 1, 0,</p>
<p style="margin:5px 0px; background-color:inherit">  D3DFMT_A8R8G8B8, D3DPOOL_MANAGED,</p>
<p style="margin:5px 0px; background-color:inherit">  &amp;g_pVolumeTexture, NULL );</p>
<p style="margin:5px 0px; background-color:inherit"> if( FAILED(hr) )</p>
<p style="margin:5px 0px; background-color:inherit">  return hr;</p>
<p style="margin:5px 0px; background-color:inherit"> //填充立体纹理</p>
<p style="margin:5px 0px; background-color:inherit"> <span style="color:#00b050; background-color:inherit">D3DLOCKED_BOX LockedBox;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> hr = g_pVolumeTexture-&gt;LockBox( 0, &amp;LockedBox, 0, 0 );</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> if( FAILED(hr) )</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  return hr;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> for( UINT w=0; w&lt;16; w++ )</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> {</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  BYTE* pSliceStart = (BYTE*)LockedBox.pBits;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  for( UINT v=0; v&lt;16; v++ )</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  {</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">   for( UINT u=0; u&lt;16; u++ )</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">   {</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    // du,dv,dw从[-1,1]的浮点数</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    FLOAT du = (u-7.5f)/7.5f;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    FLOAT dv = (v-7.5f)/7.5f;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    FLOAT dw = (w-7.5f)/7.5f;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    FLOAT fScale = sqrtf( du*du + dv*dv + dw*dw ) / sqrtf(1.0f);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    if( fScale &gt; 1.0f )</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    {</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">       fScale = 0.0f;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    }</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    // 取反是因为越近，颜色越明亮，越远越暗淡</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    else</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    {</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">       fScale = 1.0f – fScale;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    }</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    // rgb颜色</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    DWORD r = (DWORD)((w&lt;&lt;4)*fScale);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    DWORD g = (DWORD)((v&lt;&lt;4)*fScale);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    DWORD b = (DWORD)((u&lt;&lt;4)*fScale);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    // 填充好二维的</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">    ((DWORD*)LockedBox.pBits)[u] = 0xff000000 + (r&lt;&lt;16) + (g&lt;&lt;8) + (b);</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">   }</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">   // 下一行</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">   LockedBox.pBits = (BYTE*)LockedBox.pBits + LockedBox.RowPitch;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  }<span style="background-color:inherit; line-height:1.5"></span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  // 深度上面也是要逐像素计算颜色的，也是和2维一样分作了16像素</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  // 那么最终得到的立体纹理是一个 16X16X16的纹理内存，故可以模拟迷糊、爆炸效果.</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit">  LockedBox.pBits = pSliceStart + LockedBox.SlicePitch;</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> }</span><span style="background-color:inherit; line-height:1.5"></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="color:#00b050; background-color:inherit"> g_pVolumeTexture-&gt;UnlockBox( 0 );</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit; line-height:1.5">接着，为每个顶点指定数据，创建顶点缓冲区并填充它：</span></p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">// create vertex buffer and fill data</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">sCustomVertex vertices[] = 	<br style="background-color:inherit">{<br style="background-color:inherit">    { -3.0f, -3.0f,  0.0f, 0.0f, 1.0f, 0.0f},<br style="background-color:inherit">    { -3.0f,  3.0f,  0.0f, 0.0f, 0.0f, 0.0f},<br style="background-color:inherit">    {  3.0f, -3.0f,  0.0f, 1.0f, 1.0f, 0.0f},<br style="background-color:inherit">    {  3.0f,  3.0f,  0.0f, 1.0f, 0.0f, 0.0f}<br style="background-color:inherit">};</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit"><strong style="background-color:inherit">4）渲染立体纹理</strong></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"></span><p style="margin:5px 0px; background-color:inherit; color:rgb(0,176,80)">最后设置要渲染的纹理层和立体纹理，纹理阶段混合方法，顶点数据，并渲染它：</p><pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="color:#00b050; background-color:inherit">// set textue and stream source and vertex format<br style="background-color:inherit"></span><span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTexture(0, g_volume_texture);<br style="background-color:inherit">pd3dDevice-&gt;SetStreamSource(0, g_vertex_buffer, 0, sizeof(sCustomVertex));<br style="background-color:inherit">pd3dDevice-&gt;SetFVF(D3DFVF_CUSTOM_VERTEX);</span></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="color:#00b050; background-color:inherit">// set texture color blend method<br style="background-color:inherit"></span><span style="color:#c00000; background-color:inherit">pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLORARG1, D3DTA_TEXTURE); <br style="background-color:inherit">pd3dDevice-&gt;SetTextureStageState(0, D3DTSS_COLOROP, D3DTOP_SELECTARG1);</span></span><span style="color:#004080; background-color:inherit"><br style="background-color:inherit">pd3dDevice-&gt;SetSamplerState(0,		D3DSAMP_MINFILTER,		D3DTEXF_LINEAR);<br style="background-color:inherit">pd3dDevice-&gt;SetSamplerState(0,		D3DSAMP_MAGFILTER,		D3DTEXF_LINEAR);</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">// Clear the render target and the zbuffer <br style="background-color:inherit">V( pd3dDevice-&gt;Clear(0, NULL, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, D3DCOLOR_ARGB(0, 0, 0, 0), 1.0f, 0) );</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">// Render the scene<br style="background-color:inherit">if( SUCCEEDED( pd3dDevice-&gt;BeginScene() ) )<br style="background-color:inherit">{<br style="background-color:inherit">	pd3dDevice-&gt;DrawPrimitive(D3DPT_TRIANGLESTRIP, 0, 2);<br style="background-color:inherit">	RenderText();</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">	V(g_button_dlg.OnRender(fElapsedTime));<br style="background-color:inherit">    V( pd3dDevice-&gt;EndScene() );<br style="background-color:inherit">}</span></pre>
<p><span style="color:#00b050; background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">立体纹理和普通二维纹理的主要区别是：</span><span style="font-family:微软雅黑; font-size:14px; color:#c00000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">顶点纹理坐标是三维的，纹理对象指针的类型不同，立体纹理的创建也不同，而立体纹理在使用上和普通二维纹理基本相同。</span><br style="background-color:inherit"></span> </p>
<h2 style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"> <span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; text-align:left"><strong style="background-color:inherit">纹理压缩技术应用</strong></span></span></h2>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"></span></span><p style="margin:5px 0px; background-color:inherit">要渲染看起来真实的场景，最好是使用高分辨率而且颜色丰富的纹理，但这样的纹理可能会耗费大量的内存，例如，一张每像素16位颜色的256x 256纹理将使用128KB的内存。如果在该纹理中使用多级渐进纹理，还需要额外的43KB内存。一个使用50张这种纹理的场景将需要8MB的内存，如果需要更强的真实性，可以使用每像素32位颜色的512x 512纹理，但那就需要8倍的内存。<span style="background-color:rgb(255,255,255); line-height:1.5">为了减少纹理消耗的系统带宽和内存空间，Direct3D支持纹理压缩和实时解压，即DXT纹理压缩。压缩后的纹理被存储在Direct3D纹理指</span><span style="background-color:rgb(255,255,255); line-height:1.5">针中，当Direct3D渲染物体时，Direct3D引擎自动对纹理进行解压。应用DXT压缩纹理不仅可以节省内存空间，而且能有效地降低纹理传输带</span><span style="background-color:rgb(255,255,255); line-height:1.5">宽，提高图形系统的整体性能。</span></p><p style="margin:5px 0px; background-color:inherit">随着DirectX对纹理压缩格式的推广，目前大部分显卡都支持DXT压缩纹理，而且DXT压缩纹理在图形质量和运行速度之间取得了很好的平衡。</p><p style="margin:5px 0px; background-color:inherit"><strong style="background-color:inherit">DXT纹理压缩格式</strong></p><p style="margin:5px 0px; background-color:inherit">DXT是一种DirectDraw表面，它以压缩形式存储图形数据，该表面可以节省大量的系统带宽和内存。即使不直接使用DXT表面渲染，也可以通
过DXT格式创建纹理的方法节省磁盘空间。Direct3D提供了D3DFMT_DXT1~D3DFMT_DXT5共5种压缩纹理格式。其中，D3DFMT_DXT1支持15位RGB和1位alpha图形格式，D3DFMT_DXT2、D3DFMT_DXT3支持12位RGB和4位alpha，D3DFMT_DXT4、D3DFMT_DXT5则采取了线性插值方式生成alpha。</p>
    <div style="background-color:rgb(255,255,255); color:rgb(51,51,51); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start">
     有3种DXTC的格式可供使用，分别是DXT1，DXT3和DXT5。
    </div>
    <div style="background-color:rgb(255,255,255); color:rgb(51,51,51); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start">
     DXT1 压缩比例：1:8 压缩比最高，它只有1Bit Alpha，Alpha通道信息几乎完全丧失。一般将不带Alpha通道的图片压缩成这种格式。如Worldwind 用的卫星图片。
    </div>
    <div style="background-color:rgb(255,255,255); color:rgb(51,51,51); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start">
     DXT3 压缩比例：1:4 使用了4Bit Alpha，可以有16个Alpha值，可很好地用于alpha通道锐利、对比强烈的半透和镂空材质。
    </div>
    <div style="background-color:rgb(255,255,255); color:rgb(51,51,51); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start">
     DXT5 压缩比例：1:4 使用了线形插值的4Bit Alpha，特别适合Alpha通道柔和的材质，比如高光掩码材质。
    </div><span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:start">大部分</span><a target="_blank" href="http://baike.baidu.com/view/721420.htm" rel="nofollow noopener noreferrer" style="background-color:rgb(255,255,255); color:rgb(19,110,194); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start" data-token="01acc0f9bb6219144992562928ddb642">3D游戏引擎</a><span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:start">都可以使用DDS格式的图片用作</span><a target="_blank" href="http://baike.baidu.com/view/366383.htm" rel="nofollow noopener noreferrer" style="background-color:rgb(255,255,255); color:rgb(19,110,194); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start" data-token="b90329f581b493a08dedeccdd4e56a9e">贴图</a><span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:start">，也可以制作</span><a target="_blank" href="http://baike.baidu.com/view/1359428.htm" rel="nofollow noopener noreferrer" style="background-color:rgb(255,255,255); color:rgb(19,110,194); font-family:arial,宋体,sans-serif; font-size:14px; font-style:normal; font-weight:normal; text-align:start" data-token="4d90ed1fc2af2b618a7dae74f9d30249">法线贴图</a><span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:start">。</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">DXT纹理压缩的应用：</span></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; text-align:left"><strong style="background-color:inherit">1）检查是否支持纹理压缩</strong></span></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; text-align:left"></span></span><pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; font-weight:normal; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">// check whether device support DXT compressed texture<br style="background-color:inherit">if(FAILED(pD3D-&gt;CheckDeviceFormat(pCaps-&gt;AdapterOrdinal, pCaps-&gt;DeviceType, AdapterFormat, 0, D3DRTYPE_TEXTURE, D3DFMT_DXT1)))<br style="background-color:inherit">	return false;</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit; font-weight:normal; color:rgb(0,176,80)"><span style="color:#004080; background-color:inherit">如果当前设备支持DXT压缩纹理，就可以直接创建DXT压缩纹理，并可以通过IDirect3DDevice9::SetTexture()函数设置
DXT压缩纹理，将其映射到物体表面。如果当前设备不支持DXT压缩纹理，仍然可以DXT压缩格式存储纹理，但在使用该纹理渲染图形前，必须将DXT压缩
格式的纹理转换为当前设备支持的格式。<br style="background-color:inherit"></span></pre>
<p><strong style="background-color:inherit">2) 创建dds格式文件，非dds格式文件也是可以使用压缩纹理的，但是dds格式可以压缩贴图大小且加载更快</strong> </p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="font-family:arial,宋体,sans-serif; color:#333333; background-color:rgb(255,255,255); line-height:1.5">ps查看和导出dds插件：</span><a target="_blank" href="https://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop" rel="nofollow noopener noreferrer" style="background-color:inherit; font-family:微软雅黑; line-height:1.5" data-token="ec7ffb634114ec2e5634f6eb25c21d64">https://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop</a></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="font-family:微软雅黑; font-size:14px; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"></span></span>
    <div style="background-color:inherit">
     <div style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left">
      <span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:start">3dsmax现在的版本都应该支持dds贴图作为才材质的了，</span>
      <span style="background-color:inherit">不过通过<a target="_blank" href="http://www.nvidia.cn/object/3dsmax_dds_plugins.html" rel="nofollow noopener noreferrer" style="background-color:rgb(255,255,255); font-family:微软雅黑; font-size:14px; font-style:normal; font-weight:normal; text-align:left" data-token="81e551e186e3d4e2f97100701c7b36a2">http://www.nvidia.cn/object/3dsmax_dds_plugins.html</a>下载的原码可以窥探一下nvidia写的导入</span>
      <span style="background-color:rgb(255,255,255)">dds的</span>
      <span style="background-color:inherit">插件代码。</span>
     </div>
     <span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">dds文件格式编辑</span>
     <strong style="background-color:inherit; line-height:1.5">DirectX</strong>
     <span style="background-color:rgb(255,255,255); line-height:1.5"><strong style="background-color:inherit"> Texture Tool 可以编辑dds文件使用的压缩格式<span style="background-color:rgb(255,255,255); font-weight:normal">DXT1，</span><span style="background-color:rgb(255,255,255); font-weight:normal">DXT3，<span style="background-color:rgb(255,255,255)">DXT5等，可以编辑文件</span></span>的<span style="font-family:arial,宋体,sans-serif; color:#333333; background-color:rgb(255,255,255); font-weight:normal">mipMap/CubeMap/VolumeMap纹理特性。可以查看alpha通道信息等，具体使用见</span></strong></span>
     <a target="_blank" href="https://msdn.microsoft.com/en-us/library/bb219744.aspx" rel="nofollow noopener noreferrer" style="background-color:inherit; line-height:1.5" data-token="b30e6afa9133377fd13a830bdc31f117">https://msdn.microsoft.com/en-us/library/bb219744.aspx</a>
     <strong style="background-color:inherit; line-height:1.5"><span style="font-family:arial,宋体,sans-serif; color:#333333; background-color:rgb(255,255,255); font-weight:normal">。</span></strong>
    </div><br style="background-color:inherit"></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="font-family:微软雅黑; background-color:inherit"><strong style="background-color:inherit">3）创建压缩纹理</strong></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="font-family:微软雅黑; background-color:inherit"><span style="color:#c00000; background-color:inherit">一般使用<span style="font-family:arial,宋体,sans-serif; font-size:14px; background-color:rgb(255,255,255); font-style:normal; text-align:start">DXT1，DXT3和DXT5类型的压缩纹理</span></span><span style="font-family:arial,宋体,sans-serif; font-size:14px; color:#333333; background-color:rgb(255,255,255); font-weight:normal; font-style:normal; text-align:start">。</span></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"></span><p style="margin:5px 0px; background-color:inherit">在使用函数IDirect3DDevice9::<span style="color:#c00000; background-color:inherit">CreateTexture()</span>创建纹理时，将参数Format设置为压缩纹理格式<span style="color:#c00000; background-color:inherit">D3DFMT_DXT1 ~ D3DFMT_DXT5</span>中的任意值，可以创建指定压缩格式的纹理，也可以通过函数D3DXCreateTextureFromFileEx()从磁盘文件中生成DXT压缩纹理：</p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="color:#c00000; background-color:inherit">D3DXCreateTextureFromFileExW</span>(pd3dDevice, L"texture.jpg", 0, 0, 5, 0, </span>D3DFMT_DXT1<span style="background-color:inherit">, D3DPOOL_MANAGED,D3DX_DEFAULT, D3DX_DEFAULT, 0xFF000000, NULL, NULL, &amp;g_texture);</span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><strong style="background-color:inherit">4）使用压缩纹理</strong></span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">在创建好压缩纹理之后，就可以和前面一样设置纹理及各项纹理渲染状态，最后进行渲染。如果当前设备支持DXT压缩纹理，那么在使用DXT纹理渲染图形时，Direct3D引擎会自动进行纹理压缩，如果当前设备不支持DXT压缩纹理，这时使用DXT压缩纹理和使用普通的非压缩纹理完全相同。</span><span style="background-color:inherit; line-height:1.5">当使用大量纹理贴图渲染复杂场景时，通过使用DXT压缩纹理可以有效提高程序运行性能。</span></p><span style="background-color:inherit"><br style="background-color:inherit"></span><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><strong style="background-color:inherit">13.纹理管理</strong></span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">如果显卡中只有64MB的视频内存，就应该考虑将哪些纹理加载和保留在内存中。可以编写一个算法让计算机来自动考虑这些问题，那么这个算法的任务是什么呢？它需要跟踪可用的纹理内存总数，并了解哪些纹理是经常用到的，而哪些纹理是很少用到的。至少，这个纹理管理算法必须能决定哪些现有的纹理资源可以通过一张纹理图来重新加载，以及应该销毁哪些表面，然后由新的纹理资源取而代之。</span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">Direct3D有一个自动的纹理管理系统，当通过CreateTexture()创建一个纹理对象时，将Pool参数指定为<span style="color:#c00000; background-color:inherit">D3DPOOL_MANAGED</span>，就是向Direct3D请求该系统的支持。纹理管理器通过一个时间戳来跟踪纹理的使用情况，这个时间戳用于记录每个纹理 对象最后被使用的时间。纹理管理器通过"最近最少使用"算法来决定哪些纹理应从视频内存中移除，若有两个纹理对象同时满足移除条件，则根据纹理属性来做进一步的判断。如果它们具有相同的优先级，则移除最近最少使用的纹理，如果它们具有相同的时间戳，则移除低优先级的纹理。</span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">通过为纹理表面调用<span style="color:#c00000; background-color:inherit">IDirect3DResource9::SetPriority()</span>函数，可以给托管的纹理赋予一个优先级，该函数声明如下：</span></p><p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="color:#004040; background-color:inherit">Assigns the resource-management priority for this resource. </span></span></p><pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="color:#004040; background-color:inherit"><strong style="background-color:inherit">DWORD SetPriority(</strong><br style="background-color:inherit"><strong style="background-color:inherit">DWORD</strong><em style="background-color:inherit">PriorityNew</em><br style="background-color:inherit"><strong style="background-color:inherit">);</strong></span></span></pre>
<h2 style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="color:#004040; background-color:inherit"><strong style="background-color:inherit">纹理优化方式</strong></span></span></h2>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><span style="color:#004040; background-color:inherit"><strong style="background-color:inherit">0）使用dds格式文件，使用<span style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-size:14px; color:#c000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left"><span style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; font-weight:normal; text-align:left">D3DFMT_DXTn来创建内存压缩纹理。</span></span></strong></span></span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit">1）将多个小图片，用TexturePacker合并为一张大图和xml配置文件，读取小图时候根据xml截取矩形区域即可。对称的纹理只需要一张即可，然后通过旋转变换。符合九宫格的图片也是只需要一张即可进行放大。太大的图片也可以切割然后进行拼接得到需要的大图片。</pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="background-color:inherit"><strong style="background-color:inherit; color:rgb(0,64,64)">2）使用</strong><span style="color:#c00000; background-color:inherit"><strong style="background-color:inherit">D3DPOOL_DEFAULT</strong></span><strong style="background-color:inherit; color:rgb(0,64,64)">常驻显存中，避免每次都调度提交，</strong></span><span style="background-color:inherit; line-height:1.5">将静态不经常变更的纹理放置在显存中(例如</span><span style="color:#c00000; background-color:inherit; line-height:1.5"><strong style="background-color:inherit"><span style="font-family:微软雅黑; background-color:rgb(254,254,242); font-weight:normal">光照贴图，</span></strong></span><span style="background-color:rgb(255,255,255); line-height:1.5"><span style="color:#c00000; background-color:inherit">地图,建筑</span>等资源)，渲染效率会更高，丢失的时候IDirect3DDevice9::Reset后要重新创建<span style="color:#c00000; background-color:inherit">恢复起来要不断的传输到显存中有点慢有时候如果是比较大量的贴图建议使用D3DPOOL_MANAGED</span>，并且显存中的纹理不能锁定更新需要<span style="color:#c00000; background-color:inherit">IDirect3DDevice9::UpdateSurface, IDirect3DDevice9::UpdateTexture</span>；和纹理不同显存中的swapchain back buffers, render targets, vertex buffers和indexbuffers都是可以锁定更新的。</span></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit">常驻内存，有频繁更新的数据，例如<span style="color:#c00000; background-color:inherit">粒子数据，骨骼蒙皮动画</span>等也是可以声明为<span style="color:#c00000; background-color:inherit"><strong style="background-color:inherit">D3DPOOL_DEFAULT</strong></span>的，<span style="background-color:rgb(254,254,242)">同时用<span style="color:#c00000; background-color:inherit">D3DUSAGE_DYNAMIC|D3DUSAGE_WRITEONLY </span>使用方式</span>标记，这意味着此资源会被创建在AGP Memory中。锁定的时候用<span style="color:#c00000; background-color:inherit">D3DLOCK_NOOVERWRITE或D3DLOCK_DISCARD可</span>以瞒天过海避免同步，且可以修改一部分渲染一部分提高CPU和GPU的并行效率。</pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><strong style="background-color:inherit">使用D3DPOOL_MANAGED</strong></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><strong style="background-color:inherit"><span style="color:#454545; background-color:inherit">交给D3D托管，<span style="color:red; background-color:inherit">渲染效率一般(</span>系统RAM/AGP内存/显存中都有)<br style="background-color:inherit"></span></strong></pre>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit"><span style="color:#454545; background-color:inherit"></span><p style="margin:5px 0px; background-color:inherit; font-weight:bold">D3DPOOL_MANAGED的资源可以自由的锁定。</p><p style="margin:5px 0px; background-color:inherit; font-weight:bold">但是只有系统内存中的副本资源数据可以直接的修改，当需要渲染的时候D3D会自动的拷贝到AGP内存和显存中。</p><p style="margin:5px 0px; background-color:inherit; font-weight:bold; display:inline!important">适用情况：由于<span style="color:#c000; background-color:inherit">D3D</span><span style="color:#c000; background-color:inherit">自己的资源管理方案很高效、使用简单，游戏中大部分资源都可以使用此标识创建</span>。</p><p style="margin:5px 0px; background-color:inherit; font-weight:bold">例子：<span style="color:#0b050; background-color:inherit">游戏中使用的大部分纹理贴图，静态模型</span>。</p><p style="margin:5px 0px; background-color:inherit; font-weight:bold"><br style="background-color:inherit"></p>D3DPOOL_SYSTEMMEM:<strong style="background-color:inherit"><br style="background-color:inherit"></strong></pre>
<p><span style="background-color:inherit"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"></span></span></span></span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"></span></span></span></span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">直接放置在系统中，<span style="color:red; background-color:inherit; font-weight:normal">渲染效率较差需要用UpdateSurface</span>或UpdateTexture拷贝到D3DPOOL_DEFAULT创建的资源，<span style="color:red; background-color:rgb(255,255,255); font-weight:normal; line-height:1.5">设备丢失时候不需要重新创建资源，锁定很方便CPU</span><span style="background-color:rgb(255,255,255); font-weight:normal; line-height:1.5">处理较快。</span><span style="background-color:rgb(255,255,255); font-weight:normal; line-height:1.5">这些资源可以被锁定(读写)，可以通过IDirect3DDevice9::UpdateSurfaceor IDirect3DDevice9::</span><span style="background-color:rgb(255,255,255); font-weight:normal; line-height:1.5">UpdateTexture函数，将该类型的资源数据，设置为用D3DPOOL_DEFAULT创建的资源的数据来源。</span><span style="background-color:rgb(255,255,255); font-weight:normal; line-height:1.5"><br style="background-color:inherit"></span><span style="background-color:rgb(255,255,255); line-height:1.5"></span></span></p>
<p style="margin:5px 0px; background-color:inherit; font-weight:normal"><span style="background-color:inherit">使用：<span style="color:#0b050; background-color:rgb(255,255,255); line-height:1.5">对于需要高频CPU</span><span style="background-color:rgb(255,255,255); line-height:1.5">读写处理的数据，推荐使用这种方式。</span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="background-color:rgb(255,255,255); line-height:1.5">D3DPOOL_SCRATCH:<br style="background-color:inherit"></span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">直接放置在系统中，<span style="color:#c000; background-color:inherit">不能直接的交给D3D</span>渲染，设备丢失时候不需要创建资源，不被设备像素格式限制可以创建锁定拷贝。</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">这些资源放置在系统RAM中，当设备丢失时不需要重新创建数据。这些数据不被设备大小和像素格式的限制。正因为如此，</span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit">这些资源不能被Direct3D访问，不能够设置为纹理或者设置为渲染目标。然而，这些资源之间总是可以被创建，锁定和拷贝。</span></p>
<p><span style="background-color:inherit">Directx 9引入这种内存池的原因是由于它从API中删除了CreateImageSurface（）的函数。通常，D3DPOOL_SCRATCH是连同CreateOffscreenPlainSurface（）一起使用的，后者将返回一个与之前通过CreateImageSurface（）来创建的、具有相同特征的表面。<span style="color:#0b050; background-color:inherit">因此，它主要用于创建图像表面</span>。</span></p>
<p style="margin:5px 0px; background-color:inherit"><font style="background-color:inherit"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left">4）使用内存池管理纹理，避免每次都从磁盘IO加载纹理，当不需要的时候及时释放，过关卡时候释放掉管理的一些场景静态纹理内存，建筑纹理，特效等等。对于纹理<font face="Arial" size="3" style="background-color:inherit"><font face="Arial" size="2" style="background-color:inherit"><font face="Arial" size="3" style="background-color:inherit"><font face="Arial" size="2" style="background-color:inherit"><font face="Arial" size="3" style="background-color:inherit"><font face="宋体" size="3" style="background-color:inherit"><font face="宋体" size="3" style="background-color:inherit"><span style="font-family:宋体; font-size:14px; background-color:inherit"><span style="font-family:Arial; font-size:14px; background-color:inherit"><span style="font-family:宋体; font-size:14px; background-color:inherit">这时可以调用</span><span style="font-family:Arial; font-size:14px; background-color:inherit">IDirect3D3::EvictManagedTextures</span><span style="font-family:宋体; font-size:14px; background-color:inherit">方法逐出所有的被管理纹理。在调用这个方法时，</span><span style="font-family:Arial; font-size:14px; background-color:inherit">Direct3D</span><span style="font-family:宋体; font-size:14px; background-color:inherit">会将所有的本地与非本地显存纹理销毁掉，只留下原始系统内存拷贝。</span></span></span></font></font></font></font></font></font></font></span></span></span></span></font></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left">5）异步读取纹理，提高IO性能，但是一定要采用异步线程机制，唤醒回调的机制，避免不断的循环浪费CPU时间。</span></span></span></span></span></p>
<p style="margin:5px 0px; background-color:inherit"><span style="background-color:inherit"><span style="background-color:rgb(255,255,255); color:rgb(0,0,0); font-family:微软雅黑; font-size:14px; font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"><span style="font-family:微软雅黑; font-size:14px; color:#000000; background-color:rgb(255,255,255); font-style:normal; text-align:left"></span></span></span></span></span></p>
<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:rgb(255,255,255); color:rgb(0,0,0); font-size:14px; font-weight:normal; text-align:left"><span style="background-color:inherit">6）暂时没有想到其它减少cpu draw call的技巧，减少内存和飙升大小的技巧，减少IO读取和提高IO读取性能，减少GPU调度和渲染纹理的技巧。</span></pre>
</pre></pre></pre></pre></div>
<p>
</p></div>
</div>
</div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>

<div class="authorbox clearfix">
	<p class="authorbox__warning">
		<strong>WARNING:</strong> Authorbox is activated, but [Author] parameters are not specified.
	</p>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/261335be215f0ef161d88d7cb3db7e23/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IOS使用navigationController跳转到下一页面黑屏问题。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/98a1b6aa66a5442da3ba4b280d85491c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Tor源码分析完整整理，书籍编撰</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<input class="widget-search__field" type="search" placeholder="Search…" value="" name="q" aria-label="Search…">
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="https://anwangtanmi.github.io/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/posts/9b95da130ea943dbd082cf1a171a19e7/">暗网网址导航大全（2021年12月更新）</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/bfac6452d61bcc1e7704a5ca15185e04/">暗网网址合集 暗网链接 Deep Web Link Director</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/c40e3e8c0724a9f9f096273235f23281/">全球十大暗网搜索引擎</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/120eca3d03790d345b608f2dbb6cae46/">最详细的暗网教程——tor洋葱浏览器的安装和使用方法</a></li>
			<li class="widget__item"><a class="widget__link" href="/posts/cf06ef810fe5b19e83228ca2e707ed26/">最新darkweb暗网搜索引擎——Tordex | The Uncensored Tor Search Engine</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/ai/">AI</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/altiumdesigner/">AltiumDesigner</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/btc/">BTC</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/darknet/">darknet</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/database/">Database</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/deeplearning/">DeepLearning</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/docker/">Docker</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/gis/">GIS</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/google/">Google</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/ios/">iOS</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/it/">IT</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/java/">java</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/life/">Life</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/linux/">linux</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/lpc/">LPC</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/macos/">macOS</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/mysql/">mysql</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/python/">Python</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/qt/">qt</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/seo/">SEO</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/threejs/">threejs</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/unity/">Unity</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1/">产品设计</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">人工智能</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/">图像处理</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%9B%BE%E5%BD%A2%E8%A7%86%E9%A2%91/">图形视频</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%90%9C%E7%B4%A2/">搜索</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%99%E7%A8%8B%E7%9F%A5%E8%AF%86/">教程知识</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%99%E8%82%B2/">教育</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/">数字图像处理</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%95%B0%E8%AE%BA/">数论</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8/">显卡驱动</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%99%BA%E8%83%BD%E6%90%9C%E7%B4%A2%E6%8A%80%E6%9C%AF/">智能搜索技术</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9/">模型压缩</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%A8%A1%E6%8B%9F%E7%94%B5%E8%B7%AF/">模拟电路</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%A8%A1%E6%8B%9F%E9%A2%98/">模拟题</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%AF%94%E7%89%B9%E5%B8%81/">比特币</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B0%B4%E4%B8%8B%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/">水下图像增强</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B5%8B%E8%AF%95/">测试</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/">浏览器</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B7%B1%E7%BD%91/">深网</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B8%B8%E6%88%8F/">游戏</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/">游戏开发</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%88%AC%E8%99%AB/">爬虫</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">环境搭建</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1/">电子商务</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A1%AC%E4%BB%B6%E8%AE%BE%E8%AE%A1/">硬件设计</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A4%BE%E5%B7%A5%E5%BA%93/">社工库</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A5%9E%E7%BB%8F%E6%9C%BA%E5%88%B6/">神经机制</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A7%BB%E5%8A%A8web/">移动web</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/">移动开发</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">程序员</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%AB%99%E9%95%BF/">站长</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%BB%9F%E8%AE%A1%E6%90%9C%E7%B4%A2/">统计搜索</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96/">网络优化</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%A7%86%E8%A7%89/">视觉</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%AE%BA%E6%96%87/">论文</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%AE%BE%E8%AE%A1/">设计</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%B5%84%E6%BA%90%E6%90%9C%E9%9B%86/">资源搜集</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%B5%84%E8%AE%AF/">资讯</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/">软件工具</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/">软件开发</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E9%80%86%E5%90%91/">逆向</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/">项目管理</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/agile/" title="Agile">Agile</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/android/" title="android">android</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/animation/" title="animation">animation</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/api/" title="api">api</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/apple/" title="apple">apple</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/application/" title="application">application</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/avi/" title="avi">avi</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/bing/" title="bing">bing</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/b%E7%AB%99%E5%90%B4%E6%81%A9%E8%BE%BE%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%A7%86%E9%A2%91%E7%AC%94%E8%AE%B0/" title="B站吴恩达深度学习视频笔记">B站吴恩达深度学习视频笔记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/c/" title="c">c</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/c&#43;&#43;/" title="c&#43;&#43;">c&#43;&#43;</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cam/" title="cam">cam</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ccie/" title="ccie">ccie</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cosine/" title="Cosine">Cosine</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/d3d%E5%AE%9E%E4%BE%8B%E6%95%99%E7%A8%8B/" title="D3D实例教程">D3D实例教程</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ddd/" title="DDD">DDD</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/deep-web/" title="Deep Web">Deep Web</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/deepdive/" title="DeepDive">DeepDive</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/deepweb/" title="DeepWeb">DeepWeb</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/directx/" title="Directx">Directx</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dl&#43;prior/" title="DL&#43;Prior">DL&#43;Prior</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/eclipse/" title="eclipse">eclipse</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/filter/" title="filter">filter</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/flash/" title="flash">flash</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/google/" title="google">google</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hack/" title="hack">hack</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hacker/" title="hacker">hacker</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/html5/reactnative/" title="html5/ReactNative">html5/ReactNative</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/http/" title="HTTP">HTTP</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ide/" title="IDE">IDE</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/idea/" title="idea">idea</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ielab/" title="ielab">ielab</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/image/" title="image">image</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/internet/" title="internet">internet</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ios/" title="IOS">IOS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ios%E5%BC%80%E5%8F%91/" title="IOS开发">IOS开发</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/iphone/" title="iphone">iphone</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/it/" title="it">it</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/java/" title="java">java</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/javascript/" title="JavaScript">JavaScript</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/kotlin-%E5%BC%80%E5%8F%91%E8%80%85%E7%A4%BE%E5%8C%BA/" title="Kotlin 开发者社区">Kotlin 开发者社区</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/layer/" title="layer">layer</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/layui-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/" title="Layui-项目实践">Layui-项目实践</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/leak/" title="leak">leak</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/life-and-entainment/" title="life and entainment">life and entainment</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/linux/" title="Linux">Linux</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mac/" title="mac">mac</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/material/" title="Material">Material</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/methods/" title="methods">methods</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsoft/" title="microsoft">microsoft</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mine/" title="mine">mine</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/network/" title="network">network</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nlp/" title="NLP">NLP</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/nmap/" title="Nmap">Nmap</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/node/" title="node">node</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/okhttp/" title="OkHttp">OkHttp</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/opencv/" title="opencv">opencv</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/os/" title="OS">OS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/php/" title="PHP">PHP</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python/" title="python">python</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python%E5%AD%A6%E4%B9%A0/" title="python学习">python学习</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="python学习笔记">python学习笔记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pytorch/" title="pytorch">pytorch</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/qq/" title="qq">qq</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/qt-%E9%A1%B9%E7%9B%AE%E4%BD%9C%E5%93%81/" title="Qt-项目作品">Qt-项目作品</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/reading-notes/" title="Reading notes">Reading notes</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ruby/" title="ruby">ruby</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/scrum/" title="Scrum">Scrum</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/seo/" title="SEO">SEO</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/setter/" title="setter">setter</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/skills/" title="Skills">Skills</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/soa/" title="soa">soa</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/socket/" title="socket">socket</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/source-code-analysis/" title="Source Code Analysis">Source Code Analysis</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/steam%E7%8E%A9%E5%85%B7/" title="STEAM玩具">STEAM玩具</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/synchronized/" title="Synchronized">Synchronized</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tcp/" title="tcp">tcp</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tensorflow/" title="tensorflow">tensorflow</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/thinkpad/" title="thinkpad">thinkpad</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tor/" title="tor">tor</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tor%E4%B8%93%E6%A0%8F/" title="Tor专栏">Tor专栏</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ubuntu/" title="ubuntu">ubuntu</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ubuntu%E9%85%8D%E7%BD%AE/" title="Ubuntu配置">Ubuntu配置</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ue4/" title="UE4">UE4</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ui/" title="UI">UI</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/url/" title="url">url</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/visual-c&#43;&#43;%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" title="Visual C&#43;&#43;游戏开发">Visual C&#43;&#43;游戏开发</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/web/" title="web">web</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/web%E5%AE%89%E5%85%A8/" title="web安全">web安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/wifi/" title="wifi">wifi</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/win7/" title="win7">win7</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows/" title="windows">windows</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%8C%E5%88%86%E6%B3%95/" title="二分法">二分法</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%92%E8%81%94%E7%BD%91/" title="互联网">互联网</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%A4%E4%BA%92/" title="交互">交互</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%A7%E5%93%81/" title="产品">产品</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" title="人工智能">人工智能</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BA%BA%E6%96%87%E5%93%B2%E5%AD%B8/" title="人文哲學">人文哲學</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BB%A3%E7%90%86/" title="代理">代理</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="代理服务器">代理服务器</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BC%81%E4%B8%9A/" title="企业">企业</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BC%98%E5%8C%96/" title="优化">优化</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BC%A0%E8%AF%B4%E4%B8%AD%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%91%98/" title="传说中的程序员">传说中的程序员</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BD%93%E8%82%B2/" title="体育">体育</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BF%A1%E5%AE%89/" title="信安">信安</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" title="【信息安全】">【信息安全】</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E6%8A%80%E6%9C%AF/" title="信息安全原理与技术">信息安全原理与技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%B1%BB/" title="信息安全类">信息安全类</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%81%A5%E5%BA%B7/" title="健康">健康</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%81%A5%E5%BA%B7%E5%B0%8F%E7%9F%A5%E8%AF%86/" title="健康小知识">健康小知识</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%85%A5%E9%97%A8%E5%9B%BE%E5%BD%A2%E5%AD%A6%E4%B9%8Bc-for-graphic/" title="入门图形学之C for Graphic">入门图形学之C for Graphic</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%85%B6%E4%BB%96/" title="其他">其他</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%85%BB%E7%94%9F/" title="养生">养生</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%88%9B%E4%B8%9A/" title="创业">创业</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%88%9B%E4%B8%9A%E6%8A%95%E8%B5%84/" title="创业投资">创业投资</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%89%8D%E7%AB%AFjs/" title="前端js">前端js</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%8A%A0%E5%AF%86/" title="加密">加密</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" title="区块链">区块链</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%8C%BB%E7%96%97/" title="医疗">医疗</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="单元测试">单元测试</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%8E%BB%E9%9B%BE%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/" title="去雾论文笔记">去雾论文笔记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%92%A8%E8%AF%A2/" title="咨询">咨询</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%9B%BD%E5%86%85%E5%A4%96%E7%AE%B4%E8%A8%80/" title="国内外箴言">国内外箴言</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%9B%BE%E5%83%8F/" title="图像">图像</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" title="图像处理">图像处理</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%9B%BE%E7%89%87/" title="图片">图片</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%9C%A8%E7%BA%BF%E7%BC%96%E7%A0%81/" title="在线编码">在线编码</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" title="大数据">大数据</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%A8%B1%E4%B9%90/" title="娱乐">娱乐</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AD%98%E5%82%A8/" title="存储">存储</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AD%A6%E4%B9%A0ing/" title="学习ing">学习ing</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AE%89%E5%85%A8/" title="安全">安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF/" title="安全技术">安全技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/" title="安全资讯">安全资讯</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/" title="实用工具">实用工具</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B0%8F%E5%B0%8F%E5%A6%99%E6%8B%9B/" title="小小妙招">小小妙招</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B0%8F%E7%9F%A5%E8%AF%86/" title="小知识">小知识</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B1%B1%E5%AF%A8%E5%B8%81/" title="山寨币">山寨币</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B7%A5%E4%B8%9A%E5%A4%A7%E8%84%91/" title="工业大脑">工业大脑</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B7%A5%E4%BD%9C/" title="工作">工作</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B7%A5%E4%BD%9C%E7%A7%AF%E7%B4%AF/" title="【工作积累】">【工作积累】</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B7%A5%E5%85%B7/" title="工具">工具</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B8%B8%E8%AF%86/" title="常识">常识</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B9%B3%E5%8F%B0/" title="平台">平台</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%B9%B4%E9%BE%84%E9%A2%84%E6%B5%8B/" title="年龄预测">年龄预测</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E5%BD%B1%E8%A7%86/" title="影视">影视</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%80%9D%E8%80%83/" title="思考">思考</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/" title="恶意软件">恶意软件</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%83%A0%E6%99%AE/" title="惠普">惠普</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%84%9F%E6%82%9F%E4%BA%BA%E7%94%9F/" title="感悟人生">感悟人生</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%89%8B%E6%9C%BA/" title="手机">手机</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%89%A9%E5%B1%95/" title="扩展">扩展</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%8A%80%E6%9C%AF/" title="技术">技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%8A%80%E6%9C%AF%E4%BA%BA/" title="技术人">技术人</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" title="技术文档">技术文档</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/" title="技术文章">技术文章</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" title="搜索引擎">搜索引擎</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%90%9E%E7%AC%91/" title="搞笑">搞笑</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%91%84%E5%83%8F%E5%A4%B4/" title="摄像头">摄像头</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统">操作系统</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E4%BD%8Ddp/" title="数位dp">数位dp</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/" title="数据安全">数据安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="数据库">数据库</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构">数据结构</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="数据结构与算法">数据结构与算法</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86/" title="数据采集">数据采集</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%95%B0%E8%AE%BA/" title="数论">数论</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%96%87%E5%AD%97/" title="文字">文字</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/" title="文献阅读">文献阅读</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%96%B0%E8%83%BD%E6%BA%90/" title="新能源">新能源</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%97%85%E6%B8%B8/" title="旅游">旅游</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5/" title="无法连接">无法连接</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%97%A5%E8%AE%B0/" title="日记">日记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9A%97%E7%BD%91/" title="暗网">暗网</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="服务器">服务器</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="机器学习">机器学习</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" title="【杂七杂八】">【杂七杂八】</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9D%82%E9%A1%B9/" title="杂项">杂项</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%9E%B6%E6%9E%84/" title="架构">架构</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%A1%86%E6%9E%B6/" title="框架">框架</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E5%8A%A0%E9%80%9F/" title="模型压缩加速">模型压缩加速</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B1%BD%E8%BD%A6can%E6%80%BB%E7%BA%BF/" title="汽车CAN总线">汽车CAN总线</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B4%BB%E5%8A%A8/" title="活动">活动</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B5%8B%E8%AF%95/" title="测试">测试</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" title="测试工具">测试工具</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" title="浏览器">浏览器</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B5%B7%E7%9B%97%E6%B9%BEthe-pirate-bay/" title="海盗湾（The Pirate Bay）">海盗湾（The Pirate Bay）</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="深度学习">深度学习</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B7%B1%E7%BD%91/" title="深网">深网</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" title="渗透测试">渗透测试</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B8%B8%E6%88%8F/" title="游戏">游戏</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" title="游戏开发">游戏开发</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%85%A7%E7%89%87/" title="照片">照片</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%88%AC%E8%99%AB/" title="爬虫">爬虫</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="爬虫学习笔记">爬虫学习笔记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%89%9B%E5%AE%A2%E7%BD%91/" title="牛客网">牛客网</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%89%A9%E6%B5%81/" title="物流">物流</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%89%A9%E7%90%86%E5%AD%A6%E7%8C%9C%E6%83%B3/" title="物理学猜想">物理学猜想</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="环境搭建">环境搭建</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%9F%E6%B4%BB/" title="生活">生活</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%9F%E6%B4%BB%E6%96%87%E5%8C%96/" title="生活文化">生活文化</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%9F%E6%B4%BB%E8%80%8C%E5%B7%B2/" title="生活而已">生活而已</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%9F%E7%89%A9/" title="生物">生物</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%B5%E4%BF%A1/" title="电信">电信</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%B5%E8%84%91/" title="电脑">电脑</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%94%B5%E8%AF%9D/" title="电话">电话</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%99%BE%E5%BA%A6/" title="百度">百度</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%9B%91%E6%8E%A7/" title="监控">监控</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/" title="知识图谱">知识图谱</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" title="神经网络">神经网络</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A6%8F%E5%88%A9/" title="福利">福利</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" title="科学上网">科学上网</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A7%91%E6%8A%80/" title="科技">科技</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" title="移动安全">移动安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/" title="程序员">程序员</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%AC%91%E8%AF%9D/" title="笑话">笑话</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%AC%94%E8%AE%B0/" title="笔记">笔记</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%AE%97%E6%B3%95/" title="算法">算法</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%AE%A1%E7%90%86/" title="管理">管理</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%AE%A1%E7%90%86%E6%96%87%E5%AD%A6/" title="管理文学">管理文学</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%B3%BB%E7%BB%9F/" title="系统">系统</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BB%88%E7%AB%AF/" title="终端">终端</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BB%8F%E5%8E%86%E6%9D%82/" title="经历（杂）">经历（杂）</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BB%BC%E5%90%88/" title="综合">综合</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BC%96%E7%A8%8B/" title="编程">编程</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BD%91%E6%A0%BC/" title="网格">网格</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BD%91%E7%BB%9C/" title="网络">网络</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="网络安全">网络安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86/" title="网络安全知识">网络安全知识</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/" title="网络技术">网络技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E7%BE%8E%E5%9B%BD%E5%9B%BD%E5%AE%B6%E5%AE%89%E5%85%A8%E5%B1%80/" title="美国国家安全局">美国国家安全局</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%81%8A%E5%A4%A9/" title="聊天">聊天</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%81%8C%E5%9C%BA/" title="职场">职场</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" title="虚拟机">虚拟机</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%9E%8D%E8%B5%84/" title="融资">融资</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%A7%86%E8%A7%89/" title="视觉">视觉</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%A7%A3%E9%94%81/" title="解锁">解锁</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" title="计算机图形学">计算机图形学</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/" title="计算机视觉">计算机视觉</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AE%BE%E7%BD%AE/" title="设置">设置</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="设计模式">设计模式</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AF%91%E4%BD%9C/" title="译作">译作</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AF%AD%E8%A8%80/" title="语言">语言</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%AF%BB%E4%B9%A6/" title="读书">读书</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" title="路由器">路由器</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" title="软件工程">软件工程</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/" title="远程桌面">远程桌面</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%80%9A%E8%AE%AF/" title="通讯">通讯</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%87%8D%E5%81%9A%E7%B3%BB%E7%BB%9F/" title="重做系统">重做系统</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%87%91%E8%9E%8D%E7%A7%91%E6%8A%80/" title="金融科技">金融科技</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%94%81/" title="锁">锁</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%94%99%E9%A2%98%E9%9B%86/" title="错题集">错题集</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%94%AE%E7%9B%98%E8%83%8C%E5%85%89/" title="键盘背光">键盘背光</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" title="防火墙">防火墙</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%9D%9E%E6%8A%80%E6%9C%AF/" title="非技术">非技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%9F%B3%E4%B9%90/" title="音乐">音乐</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90/" title="项目分析">项目分析</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/" title="领域驱动设计">领域驱动设计</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%A3%9F%E8%B0%B1/" title="食谱">食谱</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%BB%91%E5%AE%A2/" title="黑客">黑客</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%BB%91%E5%AE%A2%E5%AE%89%E5%85%A8/" title="黑客安全">黑客安全</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%BB%91%E5%AE%A2%E6%8A%80%E6%9C%AF/" title="黑客技术">黑客技术</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%E9%BB%91%E5%B1%8F/" title="黑屏">黑屏</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 暗网探秘.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>